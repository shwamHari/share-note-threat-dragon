{
  "version": "2.4.1",
  "summary": {
    "title": "Share Note Model",
    "owner": "",
    "description": "hi",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 2,
        "title": "Share Notes Diagram",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.4.1",
        "cells": [
          {
            "position": {
              "x": 180,
              "y": 200
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "logged in user"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 3,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "328f919b-1ba7-40e3-91e3-eca790934dd1"
                },
                {
                  "group": "right",
                  "id": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
                },
                {
                  "group": "bottom",
                  "id": "8d61010c-ff29-4822-93f2-81f8f25875e0"
                },
                {
                  "group": "left",
                  "id": "6b0cbf6b-24bb-4c5e-9c07-1b639ff3f141"
                }
              ]
            },
            "id": "fce65a3b-712b-4c0c-911a-2d19fac158da",
            "data": {
              "type": "tm.Actor",
              "name": "logged in user",
              "description": "A user that has registered and logged into their account.",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "ce8dae26-209e-450f-ba44-13971e6d9655",
                  "title": "User Impersonation",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker could impersonate a legitimate user eg. by credentials of user being stolen or guessed.",
                  "mitigation": "- Implement password hashing to securely store user passwords.\n- Implement session tokens to manage and verify authenticated sessions.\n- Optionally implement multi-factor authentication (MFA) for additional security.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 1,
                  "score": ""
                },
                {
                  "id": "af73d730-9db5-4fa8-9017-544286d16d90",
                  "title": "Denial of User Actions",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": " User could deny having created, edited, or shared a note.",
                  "mitigation": "- Maintain secure audit logs of all user actions.\n- Include timestamps for each logged action.\n- Include user IDs associated with each action.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 2,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 3,
                "repudiation": 3
              }
            }
          },
          {
            "position": {
              "x": 170,
              "y": 340
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "public visitor"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 4,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "328f919b-1ba7-40e3-91e3-eca790934dd1"
                },
                {
                  "group": "right",
                  "id": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
                },
                {
                  "group": "bottom",
                  "id": "8d61010c-ff29-4822-93f2-81f8f25875e0"
                },
                {
                  "group": "left",
                  "id": "6b0cbf6b-24bb-4c5e-9c07-1b639ff3f141"
                }
              ]
            },
            "id": "c04bfb1c-4319-4739-b7ae-287e1e00ae15",
            "data": {
              "type": "tm.Actor",
              "name": "public visitor",
              "description": "Unregistered/not logged in user. Can view public notes.",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "f7a51641-353d-44c3-8137-6338973391f6",
                  "title": "Fake User Registration",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker may register with fake or spoofed credentials to abuse the system.",
                  "mitigation": "- Enforce CAPTCHA to prevent automated registrations.\n- Validate email addresses during registration.\n- Rate-limit registration attempts to deter abuse.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 3,
                  "score": ""
                },
                {
                  "id": "404ce463-5d6c-42d8-95ef-c77c195fade3",
                  "title": "Denial of Actions",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Since public users are anonymous, any interactions (like comments) cannot be definitively attributed.\n",
                  "mitigation": "- Restrict comment functionality to authenticated users.\n- Alternatively, associate anonymous actions with temporary session IDs.\n- Log all anonymous actions linked to these session IDs.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 3,
                "repudiation": 3
              }
            }
          },
          {
            "position": {
              "x": 122.5,
              "y": 30
            },
            "size": {
              "width": 170,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "messaging/sharing service"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 6,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "328f919b-1ba7-40e3-91e3-eca790934dd1"
                },
                {
                  "group": "right",
                  "id": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
                },
                {
                  "group": "bottom",
                  "id": "8d61010c-ff29-4822-93f2-81f8f25875e0"
                },
                {
                  "group": "left",
                  "id": "6b0cbf6b-24bb-4c5e-9c07-1b639ff3f141"
                }
              ]
            },
            "id": "1e5ca40c-5d45-4084-aac0-8b7d82486446",
            "data": {
              "type": "tm.Actor",
              "name": "messaging/sharing service",
              "description": "Service used for sharing links. This could be eg. email, SMS etc.",
              "isTrustBoundary": false,
              "outOfScope": true,
              "reasonOutOfScope": "This service is outside of the web app",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "9100bbdf-2f75-45c4-955a-6338b35fa62c",
                  "title": "Email Service Spoofing",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker could spoof the identity of the system’s email service, sending fake or malicious note links to users.",
                  "mitigation": "- SPF (Sender Policy Framework) – Verifies that emails are sent from authorized mail servers for your domain.\n- DKIM (DomainKeys Identified Mail) – Uses a cryptographic signature to ensure email content hasn’t been altered in transit.\n- DMARC (Domain-based Message Authentication, Reporting, and Conformance) – Aligns SPF and DKIM to authenticate emails, block spoofed messages, and provide reporting.\n\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": ""
                },
                {
                  "id": "f787e455-5e28-420b-88db-6ee85ca97034",
                  "title": "Denial of Link Share",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "There may be no reliable way to prove which user initiated a shared link email if logging is not enforced.\n",
                  "mitigation": "- Log the user ID of the person who generated the link.\n- Log the access level associated with the generated link.\n- Log the timestamp of when the link was generated.\n- Log the recipient emails/user IDs the link was sent to.\n\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 4,
                "repudiation": 2
              }
            }
          },
          {
            "position": {
              "x": 1150,
              "y": 360
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "user database"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 7,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "f0db5ae7-c357-4546-afd9-0e1feb115659"
                },
                {
                  "group": "right",
                  "id": "55775400-f3a1-4100-817f-2617e3b1cbdd"
                },
                {
                  "group": "bottom",
                  "id": "a59e0932-f89a-43d3-91e9-95f1a3489344"
                },
                {
                  "group": "left",
                  "id": "3af9aa28-92a8-4727-a203-fd601c84cc61"
                }
              ]
            },
            "id": "8a0ae770-f349-47c7-9c03-dc87a0176a6e",
            "data": {
              "type": "tm.Store",
              "name": "user database",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "26fc7b82-f90b-4cf8-9b30-c8aceecd4282",
                  "title": "Unauthorized modification of user data",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Tampering",
                  "description": "An attacker exploits vulnerabilities (e.g., SQL injection, weak access controls) to alter user data in the database, such as changing passwords or permissions.",
                  "mitigation": "- Implement strict input validation and sanitization to prevent SQL injection. \n- Use parameterized queries for database operations. \n- Enforce least privilege access controls for database accounts. \n- Regularly audit database configurations for vulnerabilities.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 77,
                  "score": ""
                },
                {
                  "id": "bba66f84-6707-43ab-be96-00a1546b6a7e",
                  "title": "Exposure of sensitive user data",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "An attacker gains unauthorized access to the database (e.g., via misconfigured access controls or server vulnerabilities), exposing credentials or personal information.",
                  "mitigation": "- Store passwords using strong hashing (e.g., bcrypt, Argon2). \n- Encrypt sensitive data (e.g., emails) in the database. \n- Restrict database access to the web application with minimal permissions. \n- Implement monitoring and logging for unauthorized access attempts.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 78,
                  "score": ""
                },
                {
                  "id": "10e28403-b72f-4e18-a941-219b53660ccd",
                  "title": "Disrupting database availability",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "An attacker overwhelms the database with queries (e.g., via malicious application requests) or exploits vulnerabilities to crash it, preventing user authentication or data access.",
                  "mitigation": "- Implement query rate limiting and optimization in the database. \n- Use a Web Application Firewall (WAF) to filter malicious requests. \n- Ensure database scalability and redundancy. \n- Monitor database performance and set alerts for unusual activity.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 79,
                  "score": ""
                },
                {
                  "id": "660a8240-7b2f-453a-9045-983bd67476d7",
                  "title": "Denial of database modifications",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "A user or attacker modifies user data (e.g., changes a password or permission) and denies performing the action, causing disputes or undetected malicious changes.",
                  "mitigation": "- Log all database operations (e.g., INSERT, UPDATE, DELETE) with timestamps, user IDs, and IP addresses. \n- Maintain an audit trail for data changes. \n- Implement version control for critical user data (e.g., permission changes). \n- Use digital signatures for high-risk operations (if applicable).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 80,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            }
          },
          {
            "position": {
              "x": 1150,
              "y": 170
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "notes database"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 8,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "f0db5ae7-c357-4546-afd9-0e1feb115659"
                },
                {
                  "group": "right",
                  "id": "55775400-f3a1-4100-817f-2617e3b1cbdd"
                },
                {
                  "group": "bottom",
                  "id": "a59e0932-f89a-43d3-91e9-95f1a3489344"
                },
                {
                  "group": "left",
                  "id": "3af9aa28-92a8-4727-a203-fd601c84cc61"
                }
              ]
            },
            "id": "801e4123-869e-437b-b43a-bd600b2f4961",
            "data": {
              "type": "tm.Store",
              "name": "notes database",
              "description": "The database that stores all information that each note contains. Includes hypelinks, images, text.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "02c20df2-4126-4918-a587-11db866bc40c",
                  "title": "Unauthorized Changes of Notes in Database",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Tampering",
                  "description": "An attacker gains write access to the notes database (e.g., via SQL injection or compromised credentials) and alters note text, images, or links without authorization. ",
                  "mitigation": "- Implement parameterized queries and use an ORM to prevent SQL injection.\n- Maintain integrity checks (hashes) for stored note content. \n- Regularly monitor and log all database write operations.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 108,
                  "score": ""
                },
                {
                  "id": "c4e7598d-c9f5-453a-9b79-3886e8383605",
                  "title": "Private Note Data Leak",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Database or app flaw exposes private/shared notes to unauthorized users.",
                  "mitigation": "- Encrypt data at rest to protect stored information.\n- Enforce authentication checks before granting access.\n- Limit query output to only necessary data.\n- Segment the database from the internet to reduce exposure.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 109,
                  "score": ""
                },
                {
                  "id": "0d6fe5e8-73bc-418b-98cf-f8037816cb19",
                  "title": "Database Overload (DoS)",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Denial of service",
                  "description": "Excessive read/write requests exhaust DB resources, blocking note access.",
                  "mitigation": "- Rate limit requests to prevent overload.\n- Optimize queries for better performance.\n- Cap the number of connections to the system.\n- Block abusive IP addresses to enhance security.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 110,
                  "score": ""
                },
                {
                  "id": "7c7ac859-63ab-4db1-8d9f-54c6ce532571",
                  "title": "Untracked Note Changes",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "Lack of audit logs lets users modify/delete notes and deny it.",
                  "mitigation": "- Keep immutable logs of all actions.\n- Include user ID and timestamp in each log entry.\n- Secure logs to prevent tampering or unauthorized modification.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 111,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 4,
                "repudiation": 3,
                "informationDisclosure": 3,
                "denialOfService": 3
              }
            }
          },
          {
            "position": {
              "x": 685,
              "y": 570
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "register"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 9,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5a9c4503-d326-46af-b20e-9239abda1c97"
                },
                {
                  "group": "right",
                  "id": "a134f719-045f-4081-a587-57fca23a13f7"
                },
                {
                  "group": "bottom",
                  "id": "0a89bf28-b545-44c1-8ea6-ba266d47bd1b"
                },
                {
                  "group": "left",
                  "id": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
                }
              ]
            },
            "id": "ef32ab02-61c2-4382-bb7e-a6c2a3df70a1",
            "data": {
              "type": "tm.Process",
              "name": "register",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "6dc1971e-4621-431e-b2b9-32775ba8d941",
                  "title": "Impersonation during registration",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker registers with fake credentials (e.g., using someone else’s email) to gain unauthorized access or mislead users.",
                  "mitigation": "- Implement email verification (e.g., confirmation link). \n - Use CAPTCHA to prevent bot registrations. \n - Validate input for authenticity (e.g., email format).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 56,
                  "score": ""
                },
                {
                  "id": "9b36dcbc-b590-4a73-af17-ce55cdaab662",
                  "title": "Modification of registration data in transit",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "An attacker intercepts and alters registration data (e.g., username, password) during transmission, potentially creating a malicious account.",
                  "mitigation": "- Enforce HTTPS with strong TLS configurations. \n - Implement server-side input validation and sanitization. \n - Use secure session management.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 57,
                  "score": ""
                },
                {
                  "id": "34d60ccc-92f2-42c1-8409-7c477f0c6ccf",
                  "title": "Denial of registration actions",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "A malicious user registers an account and denies creating it to avoid accountability for actions taken with the account.",
                  "mitigation": "- Log registration attempts with timestamps, IP addresses, and user details. \n - Require email verification for traceability. \n - Use digital signatures (if applicable).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 58,
                  "score": ""
                },
                {
                  "id": "8b0ab409-0d3c-4ded-91cd-fa2dc6196f41",
                  "title": "Exposure of user credentials",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "An attacker gains access to sensitive registration data (e.g., passwords, emails) due to improper storage or transmission vulnerabilities.",
                  "mitigation": "- Store passwords using strong hashing (e.g., bcrypt, Argon2). \n - Ensure HTTPS for all transmission. \n - Restrict database access to the web application. \n - Audit server/database configurations.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 59,
                  "score": ""
                },
                {
                  "id": "4e0801cf-b181-42be-9011-649c2a3ec3e3",
                  "title": "Overloading the registration endpoint",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker floods the registration endpoint with requests, preventing legitimate users from registering.",
                  "mitigation": "- Implement rate limiting on the registration endpoint. \n - Use CAPTCHA to deter automated attacks. \n - Deploy a Web Application Firewall (WAF). \n - Ensure server scalability.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 60,
                  "score": ""
                },
                {
                  "id": "4a7148f0-1f03-413b-94cc-b7e776542c28",
                  "title": "Gaining unauthorized access during registration",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Elevation of privilege",
                  "description": "An attacker exploits vulnerabilities (e.g., weak input validation) to create an account with higher privileges (e.g., admin access).",
                  "mitigation": "- Enforce strict input validation to prevent injection attacks. \n - Assign minimal privileges to new accounts. \n - Implement role-based access control (RBAC). \n - Test for privilege escalation vulnerabilities.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 61,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "user id",
              "description": "User ID",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "e0494695-0111-49f7-8847-d3563372e022",
                  "title": "User ID manipulation",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The user ID could be intercepted in order to impersonate another user by modifying the returned user ID. This could lead to unauthorized access",
                  "mitigation": "Enforce HTTPS, backend should not rely on client-supplied user ID's, use server-side session storage",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 87,
                  "score": ""
                },
                {
                  "id": "b3f216db-ba5f-4b2f-b02c-f4707bb740ce",
                  "title": "Exposed user ID",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "The user ID could be intercepted, allowing attafckers to use disclosed user ID's to find data associated with other users",
                  "mitigation": "Use HTTPS, use UUID to not expose raw ID's, do not expose unnecessary user metadata in reponse",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 88,
                  "score": ""
                },
                {
                  "id": "68187bad-377d-4e00-a646-af420d91b5f6",
                  "title": "Repeated login token requests",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "The login endpoint could be abused to cause repeated authentications, overloading the system",
                  "mitigation": "Rate limit login attempts, monitor and alert for abnormal traffic",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 89,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "user id"
            ],
            "id": "1c4059eb-1c6f-4b9b-86f0-39b421238919",
            "source": {
              "cell": "848f4e3c-d035-4982-8bbc-6f51baed3bf2",
              "port": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
            },
            "target": {
              "cell": "fce65a3b-712b-4c0c-911a-2d19fac158da",
              "port": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
            },
            "vertices": [
              {
                "x": 510,
                "y": 410
              },
              {
                "x": 480,
                "y": 390
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "user details",
              "description": "Username or email, and password",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "6b610faa-31a1-4890-b8b1-8e0177985d25",
                  "title": "Manipulation of login credentials",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Login requests are altered while in transit, changing various fields possibly allowing unauthorized access or account hijacking.",
                  "mitigation": "Enforce HTTPS, validation and sanitization of all login input",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 84,
                  "score": ""
                },
                {
                  "id": "a991b840-cb74-42be-a343-27929d98014c",
                  "title": "Exposed login data",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Login data can be exposed during transit if it is not properly protected, this could allow attackers to reuse credientials across systems.",
                  "mitigation": "Enforce HTTPS, do not log senstive data such as passwords or auth tokens, mask sensitive information such as the password in the UI",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 85,
                  "score": ""
                },
                {
                  "id": "efacd988-d303-469e-aa1c-176aeef781e2",
                  "title": "Brute-Force attacks",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "The login endpoint could be flooded with repeated log in attempts to guess user credentials",
                  "mitigation": "Rate limit login attempts, lock accounts if there are many repeated login attempts, and use CAPCHAs",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 86,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "user details"
            ],
            "id": "76e6b231-1fc0-4ff4-a360-6d6219719ecc",
            "source": {
              "cell": "c04bfb1c-4319-4739-b7ae-287e1e00ae15",
              "port": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
            },
            "target": {
              "cell": "848f4e3c-d035-4982-8bbc-6f51baed3bf2",
              "port": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
            },
            "vertices": [
              {
                "x": 430,
                "y": 430
              },
              {
                "x": 470,
                "y": 430
              },
              {
                "x": 480,
                "y": 440
              },
              {
                "x": 520,
                "y": 460
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "user details",
              "description": "Username, password, email",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "b01b19d0-e335-4e51-9843-40b04a120ae6",
                  "title": "Man-in-the-Middle Attack",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Attacker alters the registration form data to inject content that is malicious.",
                  "mitigation": "Use integrity checks (hashing, signed tokens), validate and sanitize all input on the server",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 81,
                  "score": ""
                },
                {
                  "id": "0a43a6f4-4327-41b6-a2e4-a04593937e01",
                  "title": "Exposed registration data",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Registration data is exposed in data flow due to transmission that is not secure.",
                  "mitigation": "Encrypt all traffic with HTTPS, avoid logging any sensitive data from the user",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 82,
                  "score": ""
                },
                {
                  "id": "7fb4a703-abc7-4e22-a92d-b4595658d3bf",
                  "title": "Endpoint Flooding",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacked could send a large amount of fake requests, which would lead to the system being overloaded and prevent legitimate users from registering. ",
                  "mitigation": "Implement rate limiting, use CAPCHAs, monitor and alert for abnormal traffic volumes.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 83,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 2,
                "denialOfService": 2
              }
            },
            "labels": [
              "user details"
            ],
            "id": "8426bdc6-fb38-41f1-aa57-0d05701efa98",
            "source": {
              "cell": "c04bfb1c-4319-4739-b7ae-287e1e00ae15",
              "port": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
            },
            "target": {
              "cell": "ef32ab02-61c2-4382-bb7e-a6c2a3df70a1",
              "port": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
            },
            "vertices": [
              {
                "x": 450,
                "y": 490
              },
              {
                "x": 520,
                "y": 490
              },
              {
                "x": 560,
                "y": 510
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "confirmation message",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "44f0ba1a-f20b-47f2-a8da-03e9fc5c0ae1",
                  "title": "Exposure of confirmation message content",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "An attacker intercepts the confirmation email or link, exposing sensitive data (e.g., email address, token) that could be used to hijack registration.",
                  "mitigation": "- Use secure email protocols (e.g., TLS for SMTP). \n- Minimize sensitive data in emails (e.g., avoid including passwords). \n- Use short-lived, encrypted confirmation tokens. \n- Audit email service security configurations.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 74,
                  "score": ""
                },
                {
                  "id": "35bd2fa6-ff79-4cb3-af92-9d8081bb8918",
                  "title": "Modification of confirmation message",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "An attacker alters the confirmation link in transit (e.g., changing the verification token) to hijack the registration process.",
                  "mitigation": "- Use HTTPS for link generation and validation. \n- Sign confirmation links (e.g., with HMAC) to detect tampering. \n- Use secure email protocols (e.g., TLS for SMTP). \n- Validate link integrity on the server.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 75,
                  "score": ""
                },
                {
                  "id": "ee6cf5b5-257c-46fb-8b34-91bea6e302b9",
                  "title": "Blocking confirmation message delivery",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker disrupts the email service or floods the confirmation endpoint, preventing users from receiving or activating confirmation messages.",
                  "mitigation": "- Use a reliable, scalable email service with DoS protections. \n- Implement retry mechanisms for email delivery. \n- Monitor email service availability. \n- Use a Web Application Firewall (WAF) for confirmation endpoints.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 76,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 3,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "confirmation message"
            ],
            "id": "8d94c49a-0466-4257-98f9-c24c25978d2a",
            "source": {
              "cell": "ef32ab02-61c2-4382-bb7e-a6c2a3df70a1",
              "port": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
            },
            "target": {
              "cell": "c04bfb1c-4319-4739-b7ae-287e1e00ae15",
              "port": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
            },
            "vertices": [
              {
                "x": 540,
                "y": 600
              },
              {
                "x": 500,
                "y": 580
              },
              {
                "x": 410,
                "y": 530
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "note content",
              "description": "Updated note content stored in DB.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "76574398-2d7c-48b6-85bf-85fb4713929e",
                  "title": "Unauthorized Content Changes",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "User without edit rights modifies note content via crafted requests.",
                  "mitigation": "- Check edit permissions on every request.\n- Keep immutable edit logs.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 127,
                  "score": ""
                },
                {
                  "id": "cf6901dd-16a2-4d5a-ae74-c14494357b47",
                  "title": "Content Exposure via Insecure Transmission",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Edited content intercepted if HTTPS not enforced.",
                  "mitigation": "- Enforce HTTPS for all edits.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 128,
                  "score": ""
                },
                {
                  "id": "14ccaee3-c227-43ac-b755-51e33b810e07",
                  "title": "Content Update Flood",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Rapid edit requests overwhelm DB write operations.",
                  "mitigation": "- Rate limit content updates.\n- Queue and batch writes when possible.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 129,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "note content"
            ],
            "id": "6c82c5b8-d6fc-4b06-b188-d0bd4ef40880",
            "source": {
              "cell": "3c918a4e-2cbd-4d05-8369-98637dd37ea7",
              "port": "a134f719-045f-4081-a587-57fca23a13f7"
            },
            "target": {
              "cell": "801e4123-869e-437b-b43a-bd600b2f4961",
              "port": "3af9aa28-92a8-4727-a203-fd601c84cc61"
            },
            "vertices": [
              {
                "x": 930,
                "y": 160
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "user details",
              "description": "Username, password, email",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "ccad2f0e-fc4d-4326-8fec-dee5203163bf",
                  "title": "Malicious input injection",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The note contents could be used for malicious injections  into the user database (SQL injections), through corrupted fields",
                  "mitigation": "Validate and santize all registration input on the server side before writing to the database, enforce strict schema validation in the database layer",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 102,
                  "score": ""
                },
                {
                  "id": "4278fdea-8710-4227-9c73-7fd559460de5",
                  "title": "Leaked registration data",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "If the data flow is insecure, sensitive user data may be exposed while being written to the database",
                  "mitigation": "Use HTTPS, store passwords with hashing algorithms, mask sensitive data in logs and error responses",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 103,
                  "score": ""
                },
                {
                  "id": "bb8a6819-7973-4869-bc71-57294308922e",
                  "title": "Registration flooding",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "A high volume of user registrations may be created in a short time to overload the system",
                  "mitigation": "Rate limit registration attempts per IP/user agent, implement CAPCHAs, monitor and alert for abnormal traffic",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 104,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "user details"
            ],
            "id": "116aacf5-dc76-459b-8984-07bc988c6dce",
            "source": {
              "cell": "ef32ab02-61c2-4382-bb7e-a6c2a3df70a1",
              "port": "a134f719-045f-4081-a587-57fca23a13f7"
            },
            "target": {
              "cell": "8a0ae770-f349-47c7-9c03-dc87a0176a6e",
              "port": "3af9aa28-92a8-4727-a203-fd601c84cc61"
            },
            "vertices": [
              {
                "x": 940,
                "y": 440
              },
              {
                "x": 960,
                "y": 420
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "shared user information",
              "description": "Logged-in user sends recipient details to Share Note process.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "cafb91ba-958f-4390-9f9d-12743aff53ee",
                  "title": "Unauthorized Modification of User Details",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Attacker alters recipient metadata in transit to redirect shares to themselves.",
                  "mitigation": "- Sign data payloads to prevent modification.\n- Validate user IDs server-side against active session.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 115,
                  "score": ""
                },
                {
                  "id": "385162b2-d0a7-44a2-ad81-2d203a024c7d",
                  "title": "Leakage of Recipient Metadata",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Email or username exposed via insecure transmission or logging in the Share Note process.",
                  "mitigation": "- Encrypt all transmissions.\n- Avoid storing unnecessary metadata.\n- Restrict access to API parameters containing user details.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 116,
                  "score": ""
                },
                {
                  "id": "26472278-6581-428a-a57a-e16272bf4876",
                  "title": "Metadata Flooding",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Denial of service",
                  "description": "Large volumes of fake recipient data overwhelm the Share Note process.",
                  "mitigation": "- Apply size and field validation on inputs.\n- Rate limit requests to sharing endpoints.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 117,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 2,
                "informationDisclosure": 2,
                "denialOfService": 1
              }
            },
            "labels": [
              "shared user information"
            ],
            "id": "0c2c2c62-1550-4975-a42f-2e59cb2e079c",
            "source": {
              "x": 290,
              "y": 230
            },
            "target": {
              "cell": "99f397fb-907a-4a13-9431-306b30d6d7ec",
              "port": "1957d505-d5fe-4806-a624-6de293e219c3"
            },
            "vertices": [
              {
                "x": 450,
                "y": 120
              },
              {
                "x": 450,
                "y": 80
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "shared user information",
              "description": "Recipient metadata stored in database.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "1a59dd2c-7d3f-4737-972a-e35f5b0df229",
                  "title": "Metadata Tampering in Storage",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Attacker with DB access changes recipient to themselves or removes others.",
                  "mitigation": "- Use role-based DB access controls.\n- Log and monitor changes to sharing metadata.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 124,
                  "score": ""
                },
                {
                  "id": "a4ad70c4-be65-451d-b3a0-c270d2f8deb7",
                  "title": "Metadata Leakage from DB",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Query exposes more recipient data than intended.",
                  "mitigation": "- Scope queries by note and owner.\n- Mask sensitive fields when possible.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 125,
                  "score": ""
                },
                {
                  "id": "4e791bda-d4e0-4eb8-b737-2e607315b607",
                  "title": "Metadata Query Flooding",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Denial of service",
                  "description": "Flooding metadata queries degrades DB performance.",
                  "mitigation": "- Index frequently queried fields.\n- Apply rate limits.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 126,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "shared user information"
            ],
            "id": "7ca10d23-6d49-41f6-a567-443b44318cd2",
            "source": {
              "x": 745,
              "y": 17
            },
            "target": {
              "cell": "801e4123-869e-437b-b43a-bd600b2f4961",
              "port": "3af9aa28-92a8-4727-a203-fd601c84cc61"
            },
            "vertices": [
              {
                "x": 920,
                "y": 90
              },
              {
                "x": 940,
                "y": 110
              },
              {
                "x": 960,
                "y": 110
              },
              {
                "x": 1010,
                "y": 130
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "user comment text",
              "description": "New comment text stored in DB.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "d7b811af-9bb4-49d5-a82a-c1b9cbc4b05a",
                  "title": "Comment Tampering",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Malicious payload injected in comment text for XSS or spam.",
                  "mitigation": "Sanitize all inputs server-side.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 133,
                  "score": ""
                },
                {
                  "id": "978ec8f1-baf7-4811-b039-f2ffb36c3487",
                  "title": "Comment Data Exposure in Transit",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Comment intercepted if sent over insecure channel.",
                  "mitigation": "- Enforce HTTPS.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 134,
                  "score": ""
                },
                {
                  "id": "4dcbca21-2391-45d0-9ab1-bc90ea17d9fc",
                  "title": "Comment Spam Flood",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Denial of service",
                  "description": "Excessive comments flood DB and degrade performance.",
                  "mitigation": "- Rate limit comments per user/IP.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 135,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "user comment text"
            ],
            "id": "2b334ef9-41b2-42f4-a312-48e96edb3ce2",
            "source": {
              "cell": "ae5b180e-8a5e-4c91-ade9-8e097c52e2a5",
              "port": "a134f719-045f-4081-a587-57fca23a13f7"
            },
            "target": {
              "cell": "801e4123-869e-437b-b43a-bd600b2f4961",
              "port": "3af9aa28-92a8-4727-a203-fd601c84cc61"
            },
            "vertices": [
              {
                "x": 950,
                "y": 220
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "user comment text",
              "description": "Comment plain text",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "dfefd574-1f41-460f-9f04-61c6011d1092",
                  "title": "Malicious input injection",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The comment text could be tampered with to inject malicious content (scripts, SQL injections) to affect backend processes or other users",
                  "mitigation": "Perform strict server-side input sanitization, log suspisious inputs for manual review, use secure libraries to protect against injections and attacks",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 96,
                  "score": ""
                },
                {
                  "id": "134cc0f4-d463-4c32-88fd-d0300a61700c",
                  "title": "Leaked comment metadata",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "Comment information could contain senstive information that may become public accessible of the note is shared without proper control",
                  "mitigation": "Educate users not to share private information, sanitize and audit outputs for potential leaks of sensitive information",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 97,
                  "score": ""
                },
                {
                  "id": "19ddfdb7-7b90-4b80-9ae6-930bfa1d2611",
                  "title": "Comment Flooding",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "A high volume of comments may be sent in a short time to overload the system",
                  "mitigation": "Rate limit comment submissions per user and/or per note, implement CAPCHAs, apply length limits on the comments",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 98,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "user comment text"
            ],
            "id": "d805b910-af7b-4204-8e6a-5a55afdc9763",
            "source": {
              "x": 293,
              "y": 230
            },
            "target": {
              "cell": "ae5b180e-8a5e-4c91-ade9-8e097c52e2a5",
              "port": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
            },
            "vertices": [
              {
                "x": 490,
                "y": 230
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "comment information",
              "description": "comment id, note id",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "44160c25-35ce-430c-a13b-6a4bd1d59df7",
                  "title": "Forgery of comment deletion request",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "The comment deletion request could be tampered with by modifying the comment ID or note ID ot delete comments they dont own or were not meant to delete.",
                  "mitigation": "Enforce strict authorization checks server side, use HTTPS",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 93,
                  "score": ""
                },
                {
                  "id": "8b22081f-1f78-4736-b145-70a33617a2bc",
                  "title": "Leaked comment metadata",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "The comment information could be leaked in transit, revealing data from the comment.",
                  "mitigation": "Use HTTPS, only send minimal identifiers in the deletion request (ID's, not comment plaintext)",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 94,
                  "score": ""
                },
                {
                  "id": "c812a24c-2e1e-42eb-ae1e-7c19eb48f35d",
                  "title": "Abuse of delete comment endpoint",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Denial of service",
                  "description": "Requests of comment deletions could be rapidly sent to overload the system, slowing it down",
                  "mitigation": "Rate limit comment deletions per user, monitor and alert for abnormal traffic",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 95,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "comment information"
            ],
            "id": "f98b361f-7e6c-48d6-9af6-d1ac5ae777ca",
            "source": {
              "x": 293,
              "y": 230
            },
            "target": {
              "cell": "7b72297d-a801-4de7-a35a-ca9a44b0bd85",
              "port": "1957d505-d5fe-4806-a624-6de293e219c3"
            },
            "vertices": [
              {
                "x": 480,
                "y": 260
              },
              {
                "x": 540,
                "y": 280
              },
              {
                "x": 590,
                "y": 300
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "comment information",
              "description": "DB returns stored comment data.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "5c255b25-395e-4955-9eac-12bd08fb53af",
                  "title": "Returned Comment Tampering",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Returned comment content altered maliciously before delivery.\n",
                  "mitigation": "Use signed data or server validation.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 136,
                  "score": ""
                },
                {
                  "id": "fcfb1028-7638-4ff5-8cc5-d44d993a0bbf",
                  "title": "Overexposure of Comments",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Comments from other notes visible to unauthorized users.",
                  "mitigation": "Apply strict auth checks on comment retrieval.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 137,
                  "score": ""
                },
                {
                  "id": "2033bf6b-d33c-4f20-bcb9-e8cd64a979c5",
                  "title": "Excessive Comment Retrieval",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Denial of service",
                  "description": "Flooding comment retrieval endpoint degrades performance.",
                  "mitigation": "Apply retrieval throttling and caching.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 138,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "comment information"
            ],
            "id": "f1df035d-7003-47b7-9f43-ed811c904f96",
            "source": {
              "cell": "7b72297d-a801-4de7-a35a-ca9a44b0bd85",
              "port": "84d1fee3-8893-4c6f-804d-f6b73cbbdc11"
            },
            "target": {
              "cell": "801e4123-869e-437b-b43a-bd600b2f4961",
              "port": "3af9aa28-92a8-4727-a203-fd601c84cc61"
            },
            "vertices": [
              {
                "x": 890,
                "y": 310
              },
              {
                "x": 920,
                "y": 290
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "public boolean",
              "description": "Boolean (true/false)",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "8db44eb9-1498-4f41-bc73-55c3342d469f",
                  "title": "Malicious change to note visibility",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Tampering",
                  "description": "The visibility boolean could be intercepted and altered during transmation, making a private note public which could leak sensitive data, or forcing a note to be public",
                  "mitigation": "Enforce HTTPS, use strict input validation so only booleans are accepted, validate changes server-side",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 90,
                  "score": ""
                },
                {
                  "id": "eab2eeb3-6d92-4d54-ae0a-787d2a270351",
                  "title": "Exposed note metadata",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "If the public boolean is intercepted it could reveal user intentions, allowing attackers to possible detect when notes are being made public",
                  "mitigation": "Use HTTPS, do not expose the public booleans unnecessarily, monitor and restrict metadata access to authenticated users only.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 91,
                  "score": ""
                },
                {
                  "id": "716724ff-7d96-4c94-8e60-826cd4dccd29",
                  "title": "Abuse of publicise toggle",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Denial of service",
                  "description": "Repeated toggle requests could be sent, overwhelming the system, possibly slowing it down.",
                  "mitigation": "Rate limit visiblity updates per note or per user, monitor and alert for abnormal traffic",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 92,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "public boolean"
            ],
            "id": "399068df-1d6a-40d0-ba29-98eb037d8933",
            "source": {
              "x": 293,
              "y": 230
            },
            "target": {
              "cell": "3318c40f-ec39-4ff8-b444-13905a7e3411",
              "port": "1957d505-d5fe-4806-a624-6de293e219c3"
            },
            "vertices": [
              {
                "x": 490,
                "y": 350
              },
              {
                "x": 600,
                "y": 420
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "ShareNote Secured Infrastructure\n",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              "ShareNote Secured Infrastructure\n"
            ],
            "id": "a227c7a3-a942-42d3-a655-1aa6733f6fe4",
            "source": {
              "x": 1550,
              "y": 110
            },
            "target": {
              "x": 1430,
              "y": 700
            },
            "vertices": [
              {
                "x": 1320,
                "y": 70
              },
              {
                "x": 660,
                "y": 70
              },
              {
                "x": 610,
                "y": 320
              },
              {
                "x": 640,
                "y": 480
              },
              {
                "x": 680,
                "y": 700
              },
              {
                "x": 1180,
                "y": 750
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "note content",
              "description": "images, text, and hyperlinks. ",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "64a55c46-7168-4833-90c3-1b122b0eeb23",
                  "title": "Malicious input injection",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The note contents could be used for malicious injections (scripts, SQL injections), through malicious text, images or hyperlinks leading to malicious sites.",
                  "mitigation": "Sanitize and validate all note content on the server side, restrict allowed file types and size for images use content sanitizers for text and HTML",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 99,
                  "score": ""
                },
                {
                  "id": "8d4eaf3b-df8d-47cd-a1fd-15d8f488fa05",
                  "title": "Leaked data in notes",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "Notes may accidently include sensitive information from a user, unintentially exposing confidential data",
                  "mitigation": "Educate users not to share private information, sanitize and audit outputs for potential leaks of sensitive information, allow users to preview public notes before publishing",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 100,
                  "score": ""
                },
                {
                  "id": "91cf264e-140a-40e8-9eee-2de6651c3292",
                  "title": "Note creation flooding",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "A high volume of notes may be created in a short time to overload the system",
                  "mitigation": "Rate limit note creations per user, implement CAPCHAs, apply length limits on the notes in plain test and image size",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 101,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "note content"
            ],
            "id": "b3d944fa-20a8-4d60-9224-e34a4f361afe",
            "source": {
              "x": 293,
              "y": 230
            },
            "target": {
              "cell": "3c918a4e-2cbd-4d05-8369-98637dd37ea7",
              "port": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
            },
            "vertices": [
              {
                "x": 440,
                "y": 210
              },
              {
                "x": 490,
                "y": 210
              },
              {
                "x": 510,
                "y": 190
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "shared secret token/link",
              "description": "User creates note and requests share token.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "710dd532-1848-4481-982e-382dfc9437ec",
                  "title": "Malicious Token Injection",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Attacker injects pre-generated malicious token into creation request.",
                  "mitigation": "- Server must always generate tokens itself.\n- Reject externally supplied token values.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 121,
                  "score": ""
                },
                {
                  "id": "3f6e2a9d-0b03-4743-8117-1cde9f4f6e41",
                  "title": "Token Leakage During Creation",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Newly generated token is exposed to unauthorized users during note creation.",
                  "mitigation": "Deliver tokens only via secure, authenticated channel.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 122,
                  "score": ""
                },
                {
                  "id": "dc409ceb-31fe-4c5d-a74f-cd9b1986266d",
                  "title": "Excessive Token Creation",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Attack floods note creation endpoint with requests to generate excessive tokens.",
                  "mitigation": "- Throttle note creation rate per user.\n- Use CAPTCHA for suspicious creation spikes.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 123,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "shared secret token/link"
            ],
            "id": "798ce8e6-6a3a-4604-bf66-6e83f0d5370e",
            "source": {
              "x": 293,
              "y": 230
            },
            "target": {
              "cell": "9de5d91a-06ab-4309-84f7-fc06fb50c586",
              "port": "ea2086e3-adc8-49ad-9d39-73e84fc21308"
            },
            "vertices": [
              {
                "x": 470,
                "y": 180
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "note content",
              "description": "DB retrieves stored note for editing.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "6daa1b0f-6788-4808-b422-3725bcf3dbb4",
                  "title": "Unauthorized Data Injection",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "DB returns altered or injected content due to compromise.",
                  "mitigation": "- Validate retrieved data integrity.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 130,
                  "score": ""
                },
                {
                  "id": "f9770306-03d1-4d6c-b42d-0d754d9a9317",
                  "title": "Overexposure of Notes",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Editor sees other users’ notes due to missing filters.",
                  "mitigation": "- Scope DB queries by user rights.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 131,
                  "score": ""
                },
                {
                  "id": "cebc1314-840b-46fd-bf4e-91a3b04026ba",
                  "title": "Excessive Retrieval Requests",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Continuous retrieval requests degrade performance.",
                  "mitigation": "Throttle repeated retrievals.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 132,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "note content"
            ],
            "id": "0f456933-a2b7-4199-8bf1-8d0b218b1d40",
            "source": {
              "x": 840,
              "y": 180
            },
            "target": {
              "cell": "801e4123-869e-437b-b43a-bd600b2f4961",
              "port": "3af9aa28-92a8-4727-a203-fd601c84cc61"
            },
            "vertices": [
              {
                "x": 980,
                "y": 180
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "shared secret token/link",
              "description": "Messaging service sends a unique secret link to the Share Note process for access control.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "23ad9b79-9e59-48bd-a7a3-d578581c4e56",
                  "title": "Intercepted Share Token from Messaging Service",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "If the token is intercepted in transit or guessed due to low randomness, an attacker could access the shared note without authorization.",
                  "mitigation": "- Use long, cryptographically random tokens.\n- Transmit only over HTTPS.\n- Expire tokens quickly or after single use.\n- Log and monitor token use for anomalies.\n\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 112,
                  "score": ""
                },
                {
                  "id": "e04fc958-e093-4099-8fee-e8ac5dc4ac5d",
                  "title": "Token Interception or Guessing",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Weak or exposed token allows unauthorized viewing or editing of a note.",
                  "mitigation": "- Use long, random, unguessable tokens.\n- Expire tokens after short periods or single use.\n- Limit scope of token access.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 113,
                  "score": ""
                },
                {
                  "id": "08d2269f-5c99-4dd7-b6d4-63a3297ae543",
                  "title": "Token Flooding Attack",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Denial of service",
                  "description": "Automated requests try large volumes of guessed tokens, overwhelming verification endpoints.",
                  "mitigation": "- Implement rate limiting on token checks.\n- Block IPs with repeated failed token attempts.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 114,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 2,
                "denialOfService": 1
              }
            },
            "labels": [
              "shared secret token/link"
            ],
            "id": "a0fccd88-89d5-44b5-8676-6e92ff8e32fb",
            "source": {
              "x": 680,
              "y": -10
            },
            "target": {
              "cell": "1e5ca40c-5d45-4084-aac0-8b7d82486446",
              "port": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
            },
            "vertices": [
              {
                "x": 610,
                "y": -10
              },
              {
                "x": 550,
                "y": 20
              },
              {
                "x": 430,
                "y": 20
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "shared secret token/link",
              "description": "User generates a share token via Share Note.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "d75171ae-1939-4306-ad12-d5bf36d2d77a",
                  "title": "Forged Token Submission",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Attacker submits forged token to gain access to another user’s note.",
                  "mitigation": "- Validate token ownership in backend.\n- Require authentication before token creation.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 118,
                  "score": ""
                },
                {
                  "id": "2fdcf3ef-25ee-4eb3-80b3-64fecf14c808",
                  "title": "Token Leakage from UI or Logs",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Share token is visible in client logs, browser history, or screenshots.",
                  "mitigation": "- Hide tokens in UI where possible.\n- Avoid logging tokens in plaintext.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 119,
                  "score": ""
                },
                {
                  "id": "137650dd-e277-4f90-ae65-4c92b6993613",
                  "title": "Token Generation Abuse",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Repeated token generation floods DB with unused entries.",
                  "mitigation": "- Limit token creation per note per timeframe.\n- Purge unused tokens periodically.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 120,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "shared secret token/link"
            ],
            "id": "fa313955-6163-4af7-8423-66bdc0f1de85",
            "source": {
              "x": 720,
              "y": 30
            },
            "target": {
              "cell": "fce65a3b-712b-4c0c-911a-2d19fac158da",
              "port": "328f919b-1ba7-40e3-91e3-eca790934dd1"
            },
            "vertices": [
              {
                "x": 580,
                "y": 60
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "public boolean",
              "description": "Boolean (true/false)",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "7414451b-a965-4466-a06d-323ab1a365e8",
                  "title": "Modification of publicise note toggle",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Tampering",
                  "description": "The public boolean value could be tampered with during transmission to the database, potentially changing a note's visibility without authorization",
                  "mitigation": "Encrypt all internal communications, implement strict server-side validation, user database constraints to enforce valid boolean values",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 105,
                  "score": ""
                },
                {
                  "id": "920cc20d-72ad-4d5c-b9e8-c66b356dc6cf",
                  "title": "Leaked note visibility status",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "The visibility status could be exposed in logs, leading to the leakage of metadata about note sharing",
                  "mitigation": "Limit access to the database to authorized people, avoid logging senstive metadata unnecessarily",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 106,
                  "score": ""
                },
                {
                  "id": "313569ab-9db4-4c8e-b29a-33075ca8e6a3",
                  "title": "Publicise note flooding",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Denial of service",
                  "description": "A high volume of note visiblity updates may be created in a short time to degrade database performance",
                  "mitigation": "Rate limit public note toggles per note and/or per user, monitor database performance and abnormal traffic",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 107,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "public boolean"
            ],
            "id": "124c55ab-6d2e-402d-9042-612044273d59",
            "source": {
              "cell": "3318c40f-ec39-4ff8-b444-13905a7e3411",
              "port": "84d1fee3-8893-4c6f-804d-f6b73cbbdc11"
            },
            "target": {
              "cell": "801e4123-869e-437b-b43a-bd600b2f4961",
              "port": "3af9aa28-92a8-4727-a203-fd601c84cc61"
            },
            "vertices": [
              {
                "x": 865,
                "y": 400
              },
              {
                "x": 920,
                "y": 370
              },
              {
                "x": 960,
                "y": 350
              },
              {
                "x": 980,
                "y": 330
              }
            ]
          },
          {
            "position": {
              "x": 685,
              "y": 490
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "login"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 11,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5a9c4503-d326-46af-b20e-9239abda1c97"
                },
                {
                  "group": "right",
                  "id": "a134f719-045f-4081-a587-57fca23a13f7"
                },
                {
                  "group": "bottom",
                  "id": "0a89bf28-b545-44c1-8ea6-ba266d47bd1b"
                },
                {
                  "group": "left",
                  "id": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
                }
              ]
            },
            "id": "848f4e3c-d035-4982-8bbc-6f51baed3bf2",
            "data": {
              "type": "tm.Process",
              "name": "login",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "8e14ed61-81a0-41d7-81b3-729aac67f114",
                  "title": "Credential stuffing or brute force login",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker uses stolen credentials or brute-forces username/password combinations to impersonate a legitimate user.",
                  "mitigation": "- Implement rate limiting on login attempts. \n- Use CAPTCHA to prevent automated attacks. \n- Enforce account lockout after repeated failed attempts. \n- Encourage strong passwords and offer multi-factor authentication (MFA).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 62,
                  "score": ""
                },
                {
                  "id": "783407c4-341b-4ae3-92ab-d8d6ecbbcb93",
                  "title": "Modification of login data in transit",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "An attacker intercepts and alters login credentials (e.g., username, password) during transmission to gain unauthorized access.",
                  "mitigation": "- Enforce HTTPS with strong TLS configurations. \n- Implement server-side input validation to reject malformed requests. \n - Use secure session tokens (e.g., signed JWTs).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 63,
                  "score": ""
                },
                {
                  "id": "2fc291a0-f11a-49fd-8f93-9f0c04bf01aa",
                  "title": "Denial of login actions",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "A malicious user logs in and denies performing actions (e.g., accessing or modifying notes), claiming unauthorized access occurred.",
                  "mitigation": "- Log login attempts (successful and failed) with timestamps, IP addresses, and user details. \n- Use session tracking to correlate actions to authenticated users. \n- Implement MFA for stronger user attribution.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 64,
                  "score": ""
                },
                {
                  "id": "ee5c817c-f595-4854-ad85-c533cff770a3",
                  "title": "Exposure of login credentials",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "An attacker intercepts credentials or session tokens due to vulnerabilities in transmission or storage, compromising user accounts.",
                  "mitigation": "- Store passwords using strong hashing (e.g., bcrypt, Argon2). \n- Use secure, HttpOnly, and SameSite cookies for session tokens. \n-  Ensure HTTPS for all transmission. \n - Restrict database access and audit configurations.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 65,
                  "score": ""
                },
                {
                  "id": "0414eb79-e47b-4733-92f2-5ff89f368abb",
                  "title": "Overloading the login endpoint",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker floods the login endpoint with requests, preventing legitimate users from accessing the system.",
                  "mitigation": "- Implement rate limiting on login attempts. \n- Use CAPTCHA to deter automated attacks. \n- Deploy a Web Application Firewall (WAF). \n- Ensure server scalability for high loads.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 66,
                  "score": ""
                },
                {
                  "id": "4b1f7a25-7bf9-4a76-adf6-b12409e70b62",
                  "title": "Exploiting login to gain higher privileges",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Elevation of privilege",
                  "description": "An attacker exploits vulnerabilities (e.g., session hijacking, weak authentication) to gain unauthorized access to privileged features (e.g., admin rights).",
                  "mitigation": "- Use secure session management (e.g., short-lived, signed tokens).  \n- Implement role-based access control (RBAC) with minimal privileges. \n- Validate authentication flows to prevent session hijacking. \n - Test for privilege escalation vulnerabilities.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 67,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 2,
                "repudiation": 2,
                "informationDisclosure": 2,
                "denialOfService": 2,
                "elevationOfPrivilege": 2
              }
            }
          },
          {
            "position": {
              "x": 635,
              "y": 90
            },
            "size": {
              "width": 110,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "Create Note"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 12,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5a9c4503-d326-46af-b20e-9239abda1c97"
                },
                {
                  "group": "right",
                  "id": "a134f719-045f-4081-a587-57fca23a13f7"
                },
                {
                  "group": "bottom",
                  "id": "0a89bf28-b545-44c1-8ea6-ba266d47bd1b"
                },
                {
                  "group": "left",
                  "id": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
                }
              ]
            },
            "id": "3c918a4e-2cbd-4d05-8369-98637dd37ea7",
            "data": {
              "type": "tm.Process",
              "name": "Create Note",
              "description": "A registered and logged in user creating a note.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "fa050cc2-872b-4c6d-92fe-f75ad095d1af",
                  "title": "Spoofed Create Note Process Request",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker or malicious internal component sends forged requests pretending to be the Create Note process, creating notes without authorisation.\n",
                  "mitigation": "- Authenticate API calls within the system to ensure they originate from trusted sources.\n- Verify the identities of callers to prevent unauthorized access.\n\n\n\n\n\n\n\n\nAsk ChatGPT\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 7,
                  "score": ""
                },
                {
                  "id": "9b014e71-6282-4672-84cb-b4268597ca5e",
                  "title": "Tampering with Note Creation Data",
                  "status": "Mitigated",
                  "severity": "Critical",
                  "type": "Tampering",
                  "description": "Data passed into the Create Note process is manipulated en route or internally e.g. altering note text, images or links.",
                  "mitigation": "- Perform thorough input validation to ensure data accuracy and security.\n- Use cryptographic signing to verify the authenticity and integrity of data.\n- Implement robust integrity checks to detect and prevent data tampering.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": ""
                },
                {
                  "id": "e0811de0-24f2-4bda-9727-132fb75b5d10",
                  "title": "Unlogged Create Note Actions",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Create Note process operations are not logged, enabling denial of note creation events.\n",
                  "mitigation": "- Log every note creation event with precise timestamps.\n- Include relevant process identifiers for tracking and auditing purposes.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": ""
                },
                {
                  "id": "ebffbf2f-1d7f-4894-97ea-7c2c116fdda6",
                  "title": "Leakage of Note Data in Process",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "The Create Note process unintentionally exposes note data e.g. via logs or error messages.",
                  "mitigation": "- Prevent logging of any sensitive data to protect user privacy.\n- Sanitize logs to remove or mask confidential information before storage.\n- Implement secure error handling to avoid exposing sensitive details through error messages.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 10,
                  "score": ""
                },
                {
                  "id": "cc8bc425-6e26-4a4e-a6b1-b42024f3cd25",
                  "title": "Exhaustion via Create Note Process",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Flooding the Create Note process with requests causing resource exhaustion or crashing.\n",
                  "mitigation": "- Implement rate limiting to control and restrict the number of requests per user or IP.\n- Utilize load balancing to evenly distribute incoming traffic across servers for optimal performance and reliability.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 11,
                  "score": ""
                },
                {
                  "id": "0f5b3d9c-1886-409e-a1a7-f5f52e203bc5",
                  "title": "Unauthorised Privilege Escalation within the Create Note Process",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "The Create Note process might be exploited to bypass permission checks, allowing note creation with elevated privileges, such as creating notes under another user’s identity or with permissions the requester should not have.\n",
                  "mitigation": "- Enforce strict server-side authorization on note creation requests.\n- Ensure that users can only create notes they have explicit permission for, following the principle of least privilege.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 12,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 2,
                "repudiation": 2,
                "informationDisclosure": 2,
                "denialOfService": 2,
                "elevationOfPrivilege": 2
              }
            }
          },
          {
            "position": {
              "x": 670,
              "y": 190
            },
            "size": {
              "width": 120,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "comment note"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 13,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5a9c4503-d326-46af-b20e-9239abda1c97"
                },
                {
                  "group": "right",
                  "id": "a134f719-045f-4081-a587-57fca23a13f7"
                },
                {
                  "group": "bottom",
                  "id": "0a89bf28-b545-44c1-8ea6-ba266d47bd1b"
                },
                {
                  "group": "left",
                  "id": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
                }
              ]
            },
            "id": "ae5b180e-8a5e-4c91-ade9-8e097c52e2a5",
            "data": {
              "type": "tm.Process",
              "name": "comment note",
              "description": "A logged in user commenting on a public note or a note that has been shared with them",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "9110c435-f4fd-453c-b4cc-38a027ce10c0",
                  "title": "Spoofed Comment Process",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Malicious process or request pretending to be Comment on Note process. Malicious processes send forged requests to post comments under another user or process identity.\n",
                  "mitigation": "- Implement robust API authentication to verify user identities.\n- Conduct thorough authorization checks to ensure users have appropriate access rights.\n- Maintain secure session management to protect and manage user sessions safely.\n\n\n\n\n\n\n\n\nAsk ChatGPT\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 19,
                  "score": ""
                },
                {
                  "id": "e07fd87f-1aaa-4383-bd85-289b935bcfeb",
                  "title": "Tampering with Comment Content",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "The commenting process may be tampered with, meaning that when a user submits a comment, it may actually submit a completely different comment or under another username or on a different note altogether",
                  "mitigation": "- Perform comprehensive input validation and sanitization to ensure data safety and correctness.\n- Implement thorough integrity checks to maintain data consistency and prevent corruption.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 20,
                  "score": ""
                },
                {
                  "id": "1f791866-88b4-4d06-8aac-0c65afffd351",
                  "title": "Unlogged Comment Actions",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Comment actions are not logged, allowing denial of sharing events.\n",
                  "mitigation": "- Comprehensive logging of comments.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 21,
                  "score": ""
                },
                {
                  "id": "6daf3962-abaf-4741-a98d-138748044f57",
                  "title": "Leakage of Comment Data",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Comments exposed to unauthorised users or via logs/errors. Comments are made publicly available, even if the note itself is not public",
                  "mitigation": "- Avoid logging any sensitive data to protect user privacy.\n- Sanitize logs to remove or mask confidential information.\n- Implement secure error handling to prevent information leaks.\n- Enforce strict permission checks for accessing logs and error details.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 22,
                  "score": ""
                },
                {
                  "id": "5e3ea19e-3b21-4e76-b2ee-99403fa738d9",
                  "title": "Flooding Comment Process",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Excessive comment submissions overwhelm resources, crashing appplication. ",
                  "mitigation": "- Implement rate limiting to control the frequency of requests.\n- Ensure thorough input validation to maintain data integrity and security.\n- Use load balancing to distribute traffic evenly and improve system performance.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 23,
                  "score": ""
                },
                {
                  "id": "6c383e01-d1bd-4223-862c-42d71cab30a6",
                  "title": "Unauthorised Commenting",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Elevation of privilege",
                  "description": "A public visitor is able to comment on a note, without signing in or registering. ",
                  "mitigation": "- Enforce authorisation",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 24,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 2,
                "repudiation": 2,
                "informationDisclosure": 3,
                "denialOfService": 2,
                "elevationOfPrivilege": 2
              }
            }
          },
          {
            "position": {
              "x": 680,
              "y": -60
            },
            "size": {
              "width": 70,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "share note"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 14,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "b1ba4f0b-8db7-4234-8a3d-f050da7739d8"
                },
                {
                  "group": "right",
                  "id": "84d1fee3-8893-4c6f-804d-f6b73cbbdc11"
                },
                {
                  "group": "bottom",
                  "id": "c20d44d1-bfbb-4061-8596-b0783534c5ca"
                },
                {
                  "group": "left",
                  "id": "1957d505-d5fe-4806-a624-6de293e219c3"
                }
              ]
            },
            "id": "99f397fb-907a-4a13-9431-306b30d6d7ec",
            "data": {
              "type": "tm.Process",
              "name": "share note",
              "description": "The process of a note owner sharing their note via a messaging or sharing service. This includes the access level the recipient will have (read or write).",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "413e391a-4304-430c-b967-d2363a7b6537",
                  "title": "Spoofed Share Note Process",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Malicious process or request pretending to be Share Note process. Someone may send a malicious share link impersonating a real user.",
                  "mitigation": "API authentication, authorisation checks, secure session management.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 13,
                  "score": ""
                },
                {
                  "id": "e9790152-b9aa-4d70-b954-371974e14d9d",
                  "title": "Tampered Sharing Link Generation",
                  "status": "Mitigated",
                  "severity": "Critical",
                  "type": "Tampering",
                  "description": "The Share Note process generates or accepts tampered sharing links that grant unintended access eg. at incorrect access levels. Share Note process may actually perform some unintended action.\n",
                  "mitigation": "Input validation, cryptographically signed links.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 14,
                  "score": ""
                },
                {
                  "id": "31d96688-6714-424a-99b6-96c734b640d8",
                  "title": "Unlogged Share Note Actions",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Sharing actions are not logged, allowing denial of sharing events.\n",
                  "mitigation": "Comprehensive logging of sharing operations.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 15,
                  "score": ""
                },
                {
                  "id": "5e478a6e-c3b7-4559-a920-924bed1e43ca",
                  "title": "Unintended Exposure of Share Link or Permissions",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Share Note process leaks sharing links or permissions beyond intended recipients. This may happen via eg. error logs exposing the link.\n",
                  "mitigation": "Avoid logging sensitive data, sanitise logs, secure error handling, permission checks, secure link storage\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 16,
                  "score": ""
                },
                {
                  "id": "513c26e9-9cc2-458f-9ee8-6a55df510804",
                  "title": "Abuse of Share Note Process",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Flooding the sharing endpoint to exhaust system resources or disrupt service.",
                  "mitigation": "Rate limiting, load balancing, abuse detection",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 17,
                  "score": ""
                },
                {
                  "id": "29701e8b-54fe-4360-9da8-f1bb7780ce2e",
                  "title": "Privilege Escalation within the Share Note Process",
                  "status": "Mitigated",
                  "severity": "Critical",
                  "type": "Elevation of privilege",
                  "description": "Share Note process inadvertently grants edit permissions instead of read permission level via link tampering or logic flaws.\n",
                  "mitigation": "Enforce strict permission validation on sharing links.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 18,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 700,
              "y": 285
            },
            "size": {
              "width": 100,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "delete comment"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 15,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "b1ba4f0b-8db7-4234-8a3d-f050da7739d8"
                },
                {
                  "group": "right",
                  "id": "84d1fee3-8893-4c6f-804d-f6b73cbbdc11"
                },
                {
                  "group": "bottom",
                  "id": "c20d44d1-bfbb-4061-8596-b0783534c5ca"
                },
                {
                  "group": "left",
                  "id": "1957d505-d5fe-4806-a624-6de293e219c3"
                }
              ]
            },
            "id": "7b72297d-a801-4de7-a35a-ca9a44b0bd85",
            "data": {
              "type": "tm.Process",
              "name": "delete comment",
              "description": "The owner of a note deleting comments on their note",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "3634b2d5-30c7-412b-af81-54114eef1873",
                  "title": "Unwanted Deleted Comments",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Process receives forged delete requests from unauthorised entities. Delete requests may be unwanted by the note owner, but someone has impersonated the owner to delete comments",
                  "mitigation": "- Implement API authentication to verify users.\n- Perform authorization checks to ensure proper access.\n- Use secure session management to protect user sessions.\n\n\n\n\n\n\n\n\nAsk ChatGPT\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 25,
                  "score": ""
                },
                {
                  "id": "2627923b-ddae-409c-acdb-8543f935fb08",
                  "title": "Tampered Delete Requests",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Malformed or modified delete requests causing unintended comment deletions.\n",
                  "mitigation": "- Perform input validation on delete requests.\n- Implement integrity checks to ensure data consistency during deletions.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 26,
                  "score": ""
                },
                {
                  "id": "db303e1a-3b19-4e7e-abf3-4dbea74d0c7a",
                  "title": "Unlogged Delete Comment Actions",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Delete comment actions not logged, enabling repudiation",
                  "mitigation": "- Comprehensive logging of comment deletions.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 27,
                  "score": ""
                },
                {
                  "id": "472ac0e6-d795-4d2e-ba6b-0b7e50abb6bc",
                  "title": "Deleted Comments Recoverable",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "Deleted comment data accessible after deletion due to improper handling",
                  "mitigation": "- Implement secure data deletion policies.\n- Ensure proper deletion of comment data.\n\n\n\nAsk ChatGPT\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 28,
                  "score": ""
                },
                {
                  "id": "c5c3ad2b-eb16-465d-83c2-0b770aeb6511",
                  "title": "Mass Delete Request Flooding",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Flooding delete comment API causing service disruption.",
                  "mitigation": "- Implement rate limiting to control request frequency.\n- Use load balancing to distribute traffic efficiently.\n- Enable abuse detection to identify and prevent malicious activity.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 29,
                  "score": ""
                },
                {
                  "id": "656bc557-c20f-4ea8-858f-c3db8288c96a",
                  "title": "Unauthorised Deleting of Comments",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Non-owners of the note are able to delete comments. ",
                  "mitigation": "- Enforce strict permission checks when deleting comments.\n- Ensure the user deleting the comment is the owner.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 30,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 2,
                "repudiation": 2,
                "informationDisclosure": 2,
                "denialOfService": 2,
                "elevationOfPrivilege": 2
              }
            }
          },
          {
            "position": {
              "x": 700,
              "y": 400
            },
            "size": {
              "width": 90,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "publicise note"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 16,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "b1ba4f0b-8db7-4234-8a3d-f050da7739d8"
                },
                {
                  "group": "right",
                  "id": "84d1fee3-8893-4c6f-804d-f6b73cbbdc11"
                },
                {
                  "group": "bottom",
                  "id": "c20d44d1-bfbb-4061-8596-b0783534c5ca"
                },
                {
                  "group": "left",
                  "id": "1957d505-d5fe-4806-a624-6de293e219c3"
                }
              ]
            },
            "id": "3318c40f-ec39-4ff8-b444-13905a7e3411",
            "data": {
              "type": "tm.Process",
              "name": "publicise note",
              "description": "The owner of a note changing the viewing setting of their note (public or private with shared secret access).",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "ba5477d6-0525-4d89-bb19-65e48037e5be",
                  "title": "Spoofed Public Toggle Requests",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Process receives forged requests from unauthorised entities to toggle note visibility. This could make a note public when owner only wants it private and vice versa. ",
                  "mitigation": "- Implement API authentication to verify user identity.\n- Perform authorization checks to ensure proper access rights.\n- Authenticate users before allowing toggle operations.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 31,
                  "score": ""
                },
                {
                  "id": "3d4ee80a-1a08-45bf-9f74-f68c93df764c",
                  "title": "Tampered Public Toggle Data",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Manipulation of toggle request function which may cause unwanted and unintended actions. Manipulation of toggle request data causing unauthorised visibility changes.\n",
                  "mitigation": "- Secure toggling functionality to prevent unauthorized changes.\n- Perform input validation on all toggle inputs.\n- Implement integrity checks to ensure data consistency.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 32,
                  "score": ""
                },
                {
                  "id": "bfb15c26-69cc-434c-85d2-23b093fd7a02",
                  "title": "Unlogged Publicise Actions",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Publicise actions not logged, enabling denial of action.",
                  "mitigation": "- Comprehensive logging of Publicise actions.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 33,
                  "score": ""
                },
                {
                  "id": "ed8dbbf6-2626-46d8-91e7-e3fb3e3ccbd0",
                  "title": "Accidental Public Exposure via Process",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "Process fails to warn or confirm before making notes public, leading to accidental exposure.\n",
                  "mitigation": "- Display UI warnings to alert users of important actions.\n- Use confirmation dialogs to verify user intent before proceeding.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 34,
                  "score": ""
                },
                {
                  "id": "2b70baf5-b7c3-4188-9960-a464ef8d218d",
                  "title": "Publicise Note Request Flooding",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Flooding Publicise Note API causing service disruption.",
                  "mitigation": "- Implement rate limiting to control request frequency.\n- Use load balancing to distribute traffic efficiently.\n- Enable abuse detection to identify and prevent malicious activity.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 35,
                  "score": ""
                },
                {
                  "id": "b62fe82f-502d-4fd0-be1c-4bca3605f3eb",
                  "title": "Unauthorised Public Toggle",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Non-owners of the note are able to change publicity of the note. ",
                  "mitigation": "- Enforce strict authentication to verify user identities.\n- Enforce strict authorization to control access permissions.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 36,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 2,
                "repudiation": 2,
                "informationDisclosure": 2,
                "denialOfService": 2,
                "elevationOfPrivilege": 2
              }
            }
          },
          {
            "position": {
              "x": 780,
              "y": 150
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "edit note"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 17,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "326de36f-77b9-41f1-ac28-f44900c6d5dc"
                },
                {
                  "group": "right",
                  "id": "e6d25928-746e-46bd-a443-4759e9dc9b83"
                },
                {
                  "group": "bottom",
                  "id": "fe9b062b-4ec0-4f10-b77a-4688a5f46a9e"
                },
                {
                  "group": "left",
                  "id": "ea2086e3-adc8-49ad-9d39-73e84fc21308"
                }
              ]
            },
            "id": "9de5d91a-06ab-4309-84f7-fc06fb50c586",
            "data": {
              "type": "tm.Process",
              "name": "edit note",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "4d308c0d-72a6-4cbc-afca-e2b2ac90d877",
                  "title": "Impersonation to edit notes",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker impersonates a user with edit permissions (e.g., by stealing a session token or shared secret link) to modify notes unauthorized.",
                  "mitigation": "- Use secure, short-lived session tokens with HttpOnly and SameSite attributes. \n- Implement multi-factor authentication (MFA). \n- Ensure shared secret links are single-use or time-limited. \n- Validate user identity for edit actions.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 68,
                  "score": ""
                },
                {
                  "id": "17e3fb70-7d42-4169-aeec-30afdbe0657a",
                  "title": "Unauthorized modification of note content",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "An attacker alters note content in transit or exploits server vulnerabilities (e.g., weak input validation) to modify notes without permission.",
                  "mitigation": "- Enforce HTTPS with strong TLS configurations. \n- Implement strict server-side input validation and sanitization to prevent injection (e.g., XSS, SQL injection). \n- Validate user permissions before processing edits.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 69,
                  "score": ""
                },
                {
                  "id": "85643daf-454a-4241-afeb-2f9bbb7f0d2d",
                  "title": "Denial of note edit actions",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "A user with edit permissions modifies a note and denies making changes, causing disputes over note content.",
                  "mitigation": "- Log all note edit actions with timestamps, user IDs, and IP addresses. \n- Maintain version history for notes to track changes. \n- Require MFA for stronger user attribution.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 70,
                  "score": ""
                },
                {
                  "id": "ef5c8084-20f5-4956-a587-b46511d2b74e",
                  "title": "Exposure of note content during editing",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "An attacker intercepts note content or session data during the edit process, exposing sensitive information.",
                  "mitigation": "- Use secure, HttpOnly, and SameSite cookies for session tokens. \n- Encrypt sensitive note content in the database. \n- Restrict database access to the web application. \n- Audit server configurations for vulnerabilities.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 71,
                  "score": ""
                },
                {
                  "id": "9bdaf1cb-c68b-4325-8593-43c2bf5f8e75",
                  "title": "Disrupting the edit note functionality",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker floods the edit note endpoint, preventing users from saving or editing notes.",
                  "mitigation": "- Implement rate limiting on edit note endpoints. \n- Use a Web Application Firewall (WAF) to block malicious traffic. \n- Ensure server scalability to handle high loads. \n- Cache note data to reduce server load.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 72,
                  "score": ""
                },
                {
                  "id": "72e1cc25-71cc-4b5d-874b-4e37a03a5abc",
                  "title": "Gaining unauthorized edit permissions",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Elevation of privilege",
                  "description": "An attacker exploits vulnerabilities (e.g., session hijacking, weak permission checks) to edit notes without proper authorization.",
                  "mitigation": "- Implement role-based access control (RBAC) to enforce edit permissions. \n- Use secure session management (e.g., signed, short-lived tokens). \n- Validate permissions for every edit request. \n- Test for privilege escalation vulnerabilities.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 73,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          }
        ]
      }
    ],
    "diagramTop": 3,
    "reviewer": "",
    "threatTop": 138
  }
}