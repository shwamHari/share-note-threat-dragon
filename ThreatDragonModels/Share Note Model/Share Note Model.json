{
  "version": "2.4.1",
  "summary": {
    "title": "Share Note Model",
    "owner": "",
    "description": "hi",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 2,
        "title": "Share Notes Diagram",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.4.1",
        "cells": [
          {
            "position": {
              "x": 180,
              "y": 200
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "logged in user"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 3,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "328f919b-1ba7-40e3-91e3-eca790934dd1"
                },
                {
                  "group": "right",
                  "id": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
                },
                {
                  "group": "bottom",
                  "id": "8d61010c-ff29-4822-93f2-81f8f25875e0"
                },
                {
                  "group": "left",
                  "id": "6b0cbf6b-24bb-4c5e-9c07-1b639ff3f141"
                }
              ]
            },
            "id": "fce65a3b-712b-4c0c-911a-2d19fac158da",
            "data": {
              "type": "tm.Actor",
              "name": "logged in user",
              "description": "A user that has registered and logged into their account.",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "ce8dae26-209e-450f-ba44-13971e6d9655",
                  "title": "User Impersonation",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker could impersonate a legitimate user eg. by credentials of user being stolen or guessed.",
                  "mitigation": "Implement secure authentication mechanisms such as password hashing, session tokens, and optionally multi-factor authentication.\n\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 1,
                  "score": ""
                },
                {
                  "id": "af73d730-9db5-4fa8-9017-544286d16d90",
                  "title": "Denial of User Actions",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": " User could deny having created, edited, or shared a note.",
                  "mitigation": "Maintain secure audit logs of all user actions, including timestamps and user IDs.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 2,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "repudiation": 2
              }
            }
          },
          {
            "position": {
              "x": 170,
              "y": 340
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "public visitor"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 4,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "328f919b-1ba7-40e3-91e3-eca790934dd1"
                },
                {
                  "group": "right",
                  "id": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
                },
                {
                  "group": "bottom",
                  "id": "8d61010c-ff29-4822-93f2-81f8f25875e0"
                },
                {
                  "group": "left",
                  "id": "6b0cbf6b-24bb-4c5e-9c07-1b639ff3f141"
                }
              ]
            },
            "id": "c04bfb1c-4319-4739-b7ae-287e1e00ae15",
            "data": {
              "type": "tm.Actor",
              "name": "public visitor",
              "description": "Unregistered/not logged in user. Can view public notes.",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "f7a51641-353d-44c3-8137-6338973391f6",
                  "title": "Fake User Registration",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker may register with fake or spoofed credentials to abuse the system.",
                  "mitigation": "Enforce CAPTCHA, validate email addresses, and rate-limit registration attempts.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 3,
                  "score": ""
                },
                {
                  "id": "404ce463-5d6c-42d8-95ef-c77c195fade3",
                  "title": "Denial of Actions",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Since public users are anonymous, any interactions (like comments) cannot be definitively attributed.\n",
                  "mitigation": "Restrict comment functionality to authenticated users, or associate anonymous actions with temporary session IDs and log them.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "repudiation": 2
              }
            }
          },
          {
            "position": {
              "x": 122.5,
              "y": 30
            },
            "size": {
              "width": 170,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "messaging/sharing service"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 6,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "328f919b-1ba7-40e3-91e3-eca790934dd1"
                },
                {
                  "group": "right",
                  "id": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
                },
                {
                  "group": "bottom",
                  "id": "8d61010c-ff29-4822-93f2-81f8f25875e0"
                },
                {
                  "group": "left",
                  "id": "6b0cbf6b-24bb-4c5e-9c07-1b639ff3f141"
                }
              ]
            },
            "id": "1e5ca40c-5d45-4084-aac0-8b7d82486446",
            "data": {
              "type": "tm.Actor",
              "name": "messaging/sharing service",
              "description": "Service used for sharing links. This could be eg. email, SMS etc.",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "9100bbdf-2f75-45c4-955a-6338b35fa62c",
                  "title": "Email Service Spoofing",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker could spoof the identity of the system’s email service, sending fake or malicious note links to users.",
                  "mitigation": "Use protections like SPF, DKIM, and DMARC to prevent email spoofing and ensure email authenticity.\n\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": ""
                },
                {
                  "id": "f787e455-5e28-420b-88db-6ee85ca97034",
                  "title": "Denial of Link Share",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "There may be no reliable way to prove which user initiated a shared link email if logging is not enforced.\n",
                  "mitigation": "Log all link generation actions server-side, including information like the userID, access level, timestamp, and recipient emails/user ids.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 3,
                "repudiation": 1
              }
            }
          },
          {
            "position": {
              "x": 1150,
              "y": 360
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "user database"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 7,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "f0db5ae7-c357-4546-afd9-0e1feb115659"
                },
                {
                  "group": "right",
                  "id": "55775400-f3a1-4100-817f-2617e3b1cbdd"
                },
                {
                  "group": "bottom",
                  "id": "a59e0932-f89a-43d3-91e9-95f1a3489344"
                },
                {
                  "group": "left",
                  "id": "3af9aa28-92a8-4727-a203-fd601c84cc61"
                }
              ]
            },
            "id": "8a0ae770-f349-47c7-9c03-dc87a0176a6e",
            "data": {
              "type": "tm.Store",
              "name": "user database",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "26fc7b82-f90b-4cf8-9b30-c8aceecd4282",
                  "title": "Unauthorized modification of user data",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Tampering",
                  "description": "An attacker exploits vulnerabilities (e.g., SQL injection, weak access controls) to alter user data in the database, such as changing passwords or permissions.",
                  "mitigation": "- Implement strict input validation and sanitization to prevent SQL injection. \n- Use parameterized queries for database operations. \n- Enforce least privilege access controls for database accounts. \n- Regularly audit database configurations for vulnerabilities.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 77,
                  "score": ""
                },
                {
                  "id": "bba66f84-6707-43ab-be96-00a1546b6a7e",
                  "title": "Exposure of sensitive user data",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "An attacker gains unauthorized access to the database (e.g., via misconfigured access controls or server vulnerabilities), exposing credentials or personal information.",
                  "mitigation": "- Store passwords using strong hashing (e.g., bcrypt, Argon2). \n- Encrypt sensitive data (e.g., emails) in the database. \n- Restrict database access to the web application with minimal permissions. \n- Implement monitoring and logging for unauthorized access attempts.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 78,
                  "score": ""
                },
                {
                  "id": "10e28403-b72f-4e18-a941-219b53660ccd",
                  "title": "Disrupting database availability",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "An attacker overwhelms the database with queries (e.g., via malicious application requests) or exploits vulnerabilities to crash it, preventing user authentication or data access.",
                  "mitigation": "- Implement query rate limiting and optimization in the database. \n- Use a Web Application Firewall (WAF) to filter malicious requests. \n- Ensure database scalability and redundancy. \n- Monitor database performance and set alerts for unusual activity.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 79,
                  "score": ""
                },
                {
                  "id": "660a8240-7b2f-453a-9045-983bd67476d7",
                  "title": "Denial of database modifications",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "A user or attacker modifies user data (e.g., changes a password or permission) and denies performing the action, causing disputes or undetected malicious changes.",
                  "mitigation": "- Log all database operations (e.g., INSERT, UPDATE, DELETE) with timestamps, user IDs, and IP addresses. \n- Maintain an audit trail for data changes. \n- Implement version control for critical user data (e.g., permission changes). \n- Use digital signatures for high-risk operations (if applicable).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 80,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "tools": {
              "items": [
                "boundary",
                "button-remove"
              ],
              "name": null
            }
          },
          {
            "position": {
              "x": 1150,
              "y": 170
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "notes database"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 8,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "f0db5ae7-c357-4546-afd9-0e1feb115659"
                },
                {
                  "group": "right",
                  "id": "55775400-f3a1-4100-817f-2617e3b1cbdd"
                },
                {
                  "group": "bottom",
                  "id": "a59e0932-f89a-43d3-91e9-95f1a3489344"
                },
                {
                  "group": "left",
                  "id": "3af9aa28-92a8-4727-a203-fd601c84cc61"
                }
              ]
            },
            "id": "801e4123-869e-437b-b43a-bd600b2f4961",
            "data": {
              "type": "tm.Store",
              "name": "notes database",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 685,
              "y": 570
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "register"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 9,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5a9c4503-d326-46af-b20e-9239abda1c97"
                },
                {
                  "group": "right",
                  "id": "a134f719-045f-4081-a587-57fca23a13f7"
                },
                {
                  "group": "bottom",
                  "id": "0a89bf28-b545-44c1-8ea6-ba266d47bd1b"
                },
                {
                  "group": "left",
                  "id": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
                }
              ]
            },
            "id": "ef32ab02-61c2-4382-bb7e-a6c2a3df70a1",
            "data": {
              "type": "tm.Process",
              "name": "register",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "6dc1971e-4621-431e-b2b9-32775ba8d941",
                  "title": "Impersonation during registration",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker registers with fake credentials (e.g., using someone else’s email) to gain unauthorized access or mislead users.",
                  "mitigation": "- Implement email verification (e.g., confirmation link). \n - Use CAPTCHA to prevent bot registrations. \n - Validate input for authenticity (e.g., email format).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 56,
                  "score": ""
                },
                {
                  "id": "9b36dcbc-b590-4a73-af17-ce55cdaab662",
                  "title": "Modification of registration data in transit",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "An attacker intercepts and alters registration data (e.g., username, password) during transmission, potentially creating a malicious account.",
                  "mitigation": "- Enforce HTTPS with strong TLS configurations. \n - Implement server-side input validation and sanitization. \n - Use secure session management.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 57,
                  "score": ""
                },
                {
                  "id": "34d60ccc-92f2-42c1-8409-7c477f0c6ccf",
                  "title": "Denial of registration actions",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "A malicious user registers an account and denies creating it to avoid accountability for actions taken with the account.",
                  "mitigation": "- Log registration attempts with timestamps, IP addresses, and user details. \n - Require email verification for traceability. \n - Use digital signatures (if applicable).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 58,
                  "score": ""
                },
                {
                  "id": "8b0ab409-0d3c-4ded-91cd-fa2dc6196f41",
                  "title": "Exposure of user credentials",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "An attacker gains access to sensitive registration data (e.g., passwords, emails) due to improper storage or transmission vulnerabilities.",
                  "mitigation": "- Store passwords using strong hashing (e.g., bcrypt, Argon2). \n - Ensure HTTPS for all transmission. \n - Restrict database access to the web application. \n - Audit server/database configurations.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 59,
                  "score": ""
                },
                {
                  "id": "4e0801cf-b181-42be-9011-649c2a3ec3e3",
                  "title": "Overloading the registration endpoint",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker floods the registration endpoint with requests, preventing legitimate users from registering.",
                  "mitigation": "- Implement rate limiting on the registration endpoint. \n - Use CAPTCHA to deter automated attacks. \n - Deploy a Web Application Firewall (WAF). \n - Ensure server scalability.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 60,
                  "score": ""
                },
                {
                  "id": "4a7148f0-1f03-413b-94cc-b7e776542c28",
                  "title": "Gaining unauthorized access during registration",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Elevation of privilege",
                  "description": "An attacker exploits vulnerabilities (e.g., weak input validation) to create an account with higher privileges (e.g., admin access).",
                  "mitigation": "- Enforce strict input validation to prevent injection attacks. \n - Assign minimal privileges to new accounts. \n - Implement role-based access control (RBAC). \n - Test for privilege escalation vulnerabilities.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 61,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "user id",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "user id"
            ],
            "id": "1c4059eb-1c6f-4b9b-86f0-39b421238919",
            "source": {
              "cell": "848f4e3c-d035-4982-8bbc-6f51baed3bf2",
              "port": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
            },
            "target": {
              "cell": "fce65a3b-712b-4c0c-911a-2d19fac158da",
              "port": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "user details",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "user details"
            ],
            "id": "76e6b231-1fc0-4ff4-a360-6d6219719ecc",
            "source": {
              "cell": "c04bfb1c-4319-4739-b7ae-287e1e00ae15",
              "port": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
            },
            "target": {
              "cell": "848f4e3c-d035-4982-8bbc-6f51baed3bf2",
              "port": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "user details",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "user details"
            ],
            "id": "8426bdc6-fb38-41f1-aa57-0d05701efa98",
            "source": {
              "cell": "c04bfb1c-4319-4739-b7ae-287e1e00ae15",
              "port": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
            },
            "target": {
              "cell": "ef32ab02-61c2-4382-bb7e-a6c2a3df70a1",
              "port": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "confirmation message",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "44f0ba1a-f20b-47f2-a8da-03e9fc5c0ae1",
                  "title": "Exposure of confirmation message content",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "An attacker intercepts the confirmation email or link, exposing sensitive data (e.g., email address, token) that could be used to hijack registration.",
                  "mitigation": "- Use secure email protocols (e.g., TLS for SMTP). \n- Minimize sensitive data in emails (e.g., avoid including passwords). \n- Use short-lived, encrypted confirmation tokens. \n- Audit email service security configurations.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 74,
                  "score": ""
                },
                {
                  "id": "35bd2fa6-ff79-4cb3-af92-9d8081bb8918",
                  "title": "Modification of confirmation message",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "An attacker alters the confirmation link in transit (e.g., changing the verification token) to hijack the registration process.",
                  "mitigation": "- Use HTTPS for link generation and validation. \n- Sign confirmation links (e.g., with HMAC) to detect tampering. \n- Use secure email protocols (e.g., TLS for SMTP). \n- Validate link integrity on the server.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 75,
                  "score": ""
                },
                {
                  "id": "ee6cf5b5-257c-46fb-8b34-91bea6e302b9",
                  "title": "Blocking confirmation message delivery",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker disrupts the email service or floods the confirmation endpoint, preventing users from receiving or activating confirmation messages.",
                  "mitigation": "- Use a reliable, scalable email service with DoS protections. \n- Implement retry mechanisms for email delivery. \n- Monitor email service availability. \n- Use a Web Application Firewall (WAF) for confirmation endpoints.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 76,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 3,
                "informationDisclosure": 1,
                "denialOfService": 1
              }
            },
            "labels": [
              "confirmation message"
            ],
            "id": "8d94c49a-0466-4257-98f9-c24c25978d2a",
            "source": {
              "cell": "ef32ab02-61c2-4382-bb7e-a6c2a3df70a1",
              "port": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
            },
            "target": {
              "cell": "c04bfb1c-4319-4739-b7ae-287e1e00ae15",
              "port": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
            },
            "vertices": [
              {
                "x": 540,
                "y": 600
              },
              {
                "x": 500,
                "y": 580
              },
              {
                "x": 410,
                "y": 530
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "note content",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "note content"
            ],
            "id": "6c82c5b8-d6fc-4b06-b188-d0bd4ef40880",
            "source": {
              "cell": "3c918a4e-2cbd-4d05-8369-98637dd37ea7",
              "port": "a134f719-045f-4081-a587-57fca23a13f7"
            },
            "target": {
              "cell": "801e4123-869e-437b-b43a-bd600b2f4961",
              "port": "3af9aa28-92a8-4727-a203-fd601c84cc61"
            },
            "vertices": [
              {
                "x": 930,
                "y": 160
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "user details",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "user details"
            ],
            "id": "116aacf5-dc76-459b-8984-07bc988c6dce",
            "source": {
              "cell": "ef32ab02-61c2-4382-bb7e-a6c2a3df70a1",
              "port": "a134f719-045f-4081-a587-57fca23a13f7"
            },
            "target": {
              "cell": "8a0ae770-f349-47c7-9c03-dc87a0176a6e",
              "port": "3af9aa28-92a8-4727-a203-fd601c84cc61"
            },
            "vertices": [
              {
                "x": 960,
                "y": 420
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "shared user information",
              "description": "read or write permission",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "shared user information"
            ],
            "id": "0c2c2c62-1550-4975-a42f-2e59cb2e079c",
            "source": {
              "x": 290,
              "y": 230
            },
            "target": {
              "cell": "99f397fb-907a-4a13-9431-306b30d6d7ec",
              "port": "1957d505-d5fe-4806-a624-6de293e219c3"
            },
            "vertices": [
              {
                "x": 450,
                "y": 120
              },
              {
                "x": 450,
                "y": 80
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "shared user information",
              "description": "read or write information",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "shared user information"
            ],
            "id": "7ca10d23-6d49-41f6-a567-443b44318cd2",
            "source": {
              "x": 745,
              "y": 17
            },
            "target": {
              "cell": "801e4123-869e-437b-b43a-bd600b2f4961",
              "port": "3af9aa28-92a8-4727-a203-fd601c84cc61"
            },
            "vertices": [
              {
                "x": 920,
                "y": 90
              },
              {
                "x": 940,
                "y": 110
              },
              {
                "x": 960,
                "y": 110
              },
              {
                "x": 1010,
                "y": 130
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "user comment text",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "user comment text"
            ],
            "id": "2b334ef9-41b2-42f4-a312-48e96edb3ce2",
            "source": {
              "cell": "ae5b180e-8a5e-4c91-ade9-8e097c52e2a5",
              "port": "a134f719-045f-4081-a587-57fca23a13f7"
            },
            "target": {
              "cell": "801e4123-869e-437b-b43a-bd600b2f4961",
              "port": "3af9aa28-92a8-4727-a203-fd601c84cc61"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "user comment text",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "user comment text"
            ],
            "id": "d805b910-af7b-4204-8e6a-5a55afdc9763",
            "source": {
              "x": 293,
              "y": 230
            },
            "target": {
              "cell": "ae5b180e-8a5e-4c91-ade9-8e097c52e2a5",
              "port": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "comment information",
              "description": "comment id, note id",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "comment information"
            ],
            "id": "f98b361f-7e6c-48d6-9af6-d1ac5ae777ca",
            "source": {
              "x": 293,
              "y": 230
            },
            "target": {
              "cell": "7b72297d-a801-4de7-a35a-ca9a44b0bd85",
              "port": "1957d505-d5fe-4806-a624-6de293e219c3"
            },
            "vertices": [
              {
                "x": 540,
                "y": 280
              },
              {
                "x": 590,
                "y": 300
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "comment information",
              "description": "comment id, note id",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "comment information"
            ],
            "id": "f1df035d-7003-47b7-9f43-ed811c904f96",
            "source": {
              "cell": "7b72297d-a801-4de7-a35a-ca9a44b0bd85",
              "port": "84d1fee3-8893-4c6f-804d-f6b73cbbdc11"
            },
            "target": {
              "cell": "801e4123-869e-437b-b43a-bd600b2f4961",
              "port": "3af9aa28-92a8-4727-a203-fd601c84cc61"
            },
            "vertices": [
              {
                "x": 910,
                "y": 310
              },
              {
                "x": 940,
                "y": 290
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "public boolean",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "public boolean"
            ],
            "id": "399068df-1d6a-40d0-ba29-98eb037d8933",
            "source": {
              "x": 293,
              "y": 230
            },
            "target": {
              "cell": "3318c40f-ec39-4ff8-b444-13905a7e3411",
              "port": "1957d505-d5fe-4806-a624-6de293e219c3"
            }
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "ShareNote Secured Infrastructure\n",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              "ShareNote Secured Infrastructure\n"
            ],
            "id": "a227c7a3-a942-42d3-a655-1aa6733f6fe4",
            "source": {
              "x": 1550,
              "y": 110
            },
            "target": {
              "x": 1430,
              "y": 700
            },
            "vertices": [
              {
                "x": 1320,
                "y": 70
              },
              {
                "x": 660,
                "y": 70
              },
              {
                "x": 610,
                "y": 320
              },
              {
                "x": 640,
                "y": 480
              },
              {
                "x": 680,
                "y": 700
              },
              {
                "x": 1180,
                "y": 750
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "note content",
              "description": "images, text, and hyperlinks. ",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "note content"
            ],
            "id": "b3d944fa-20a8-4d60-9224-e34a4f361afe",
            "source": {
              "x": 293,
              "y": 230
            },
            "target": {
              "cell": "3c918a4e-2cbd-4d05-8369-98637dd37ea7",
              "port": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
            },
            "vertices": [
              {
                "x": 440,
                "y": 210
              },
              {
                "x": 470,
                "y": 210
              },
              {
                "x": 510,
                "y": 190
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "shared secret token/link",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "shared secret token/link"
            ],
            "id": "798ce8e6-6a3a-4604-bf66-6e83f0d5370e",
            "source": {
              "x": 293,
              "y": 230
            },
            "target": {
              "cell": "9de5d91a-06ab-4309-84f7-fc06fb50c586",
              "port": "ea2086e3-adc8-49ad-9d39-73e84fc21308"
            },
            "vertices": [
              {
                "x": 540,
                "y": 180
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "note content",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "note content"
            ],
            "id": "0f456933-a2b7-4199-8bf1-8d0b218b1d40",
            "source": {
              "x": 840,
              "y": 180
            },
            "target": {
              "cell": "801e4123-869e-437b-b43a-bd600b2f4961",
              "port": "3af9aa28-92a8-4727-a203-fd601c84cc61"
            },
            "vertices": [
              {
                "x": 980,
                "y": 180
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "shared secret token/link",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "shared secret token/link"
            ],
            "id": "a0fccd88-89d5-44b5-8676-6e92ff8e32fb",
            "source": {
              "x": 680,
              "y": -10
            },
            "target": {
              "cell": "1e5ca40c-5d45-4084-aac0-8b7d82486446",
              "port": "b332ec9f-a17c-48ea-8cdf-325c2411815a"
            },
            "vertices": [
              {
                "x": 610,
                "y": -10
              },
              {
                "x": 550,
                "y": 20
              },
              {
                "x": 430,
                "y": 20
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "shared secret token/link",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "shared secret token/link"
            ],
            "id": "fa313955-6163-4af7-8423-66bdc0f1de85",
            "source": {
              "x": 720,
              "y": 30
            },
            "target": {
              "cell": "fce65a3b-712b-4c0c-911a-2d19fac158da",
              "port": "328f919b-1ba7-40e3-91e3-eca790934dd1"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "public boolean",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "public boolean"
            ],
            "id": "124c55ab-6d2e-402d-9042-612044273d59",
            "source": {
              "cell": "3318c40f-ec39-4ff8-b444-13905a7e3411",
              "port": "84d1fee3-8893-4c6f-804d-f6b73cbbdc11"
            },
            "target": {
              "cell": "801e4123-869e-437b-b43a-bd600b2f4961",
              "port": "3af9aa28-92a8-4727-a203-fd601c84cc61"
            },
            "vertices": [
              {
                "x": 865,
                "y": 400
              },
              {
                "x": 920,
                "y": 370
              },
              {
                "x": 980,
                "y": 330
              }
            ]
          },
          {
            "position": {
              "x": 685,
              "y": 490
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "login"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 11,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5a9c4503-d326-46af-b20e-9239abda1c97"
                },
                {
                  "group": "right",
                  "id": "a134f719-045f-4081-a587-57fca23a13f7"
                },
                {
                  "group": "bottom",
                  "id": "0a89bf28-b545-44c1-8ea6-ba266d47bd1b"
                },
                {
                  "group": "left",
                  "id": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
                }
              ]
            },
            "id": "848f4e3c-d035-4982-8bbc-6f51baed3bf2",
            "data": {
              "type": "tm.Process",
              "name": "login",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "8e14ed61-81a0-41d7-81b3-729aac67f114",
                  "title": "Credential stuffing or brute force login",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker uses stolen credentials or brute-forces username/password combinations to impersonate a legitimate user.",
                  "mitigation": "- Implement rate limiting on login attempts. \n - Use CAPTCHA to prevent automated attacks. \n - Enforce account lockout after repeated failed attempts. \n - Encourage strong passwords and offer multi-factor authentication (MFA).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 62,
                  "score": ""
                },
                {
                  "id": "783407c4-341b-4ae3-92ab-d8d6ecbbcb93",
                  "title": "Modification of login data in transit",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "An attacker intercepts and alters login credentials (e.g., username, password) during transmission to gain unauthorized access.",
                  "mitigation": "- Enforce HTTPS with strong TLS configurations. \n - Implement server-side input validation to reject malformed requests. \n - Use secure session tokens (e.g., signed JWTs).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 63,
                  "score": ""
                },
                {
                  "id": "2fc291a0-f11a-49fd-8f93-9f0c04bf01aa",
                  "title": "Denial of login actions",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "A malicious user logs in and denies performing actions (e.g., accessing or modifying notes), claiming unauthorized access occurred.",
                  "mitigation": "- Log login attempts (successful and failed) with timestamps, IP addresses, and user details. \n - Use session tracking to correlate actions to authenticated users. \n - Implement MFA for stronger user attribution.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 64,
                  "score": ""
                },
                {
                  "id": "ee5c817c-f595-4854-ad85-c533cff770a3",
                  "title": "Exposure of login credentials",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "An attacker intercepts credentials or session tokens due to vulnerabilities in transmission or storage, compromising user accounts.",
                  "mitigation": "- Store passwords using strong hashing (e.g., bcrypt, Argon2). \n - Use secure, HttpOnly, and SameSite cookies for session tokens. \n - Ensure HTTPS for all transmission. \n - Restrict database access and audit configurations.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 65,
                  "score": ""
                },
                {
                  "id": "0414eb79-e47b-4733-92f2-5ff89f368abb",
                  "title": "Overloading the login endpoint",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker floods the login endpoint with requests, preventing legitimate users from accessing the system.",
                  "mitigation": "- Implement rate limiting on login attempts. \n - Use CAPTCHA to deter automated attacks. \n - Deploy a Web Application Firewall (WAF). \n - Ensure server scalability for high loads.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 66,
                  "score": ""
                },
                {
                  "id": "4b1f7a25-7bf9-4a76-adf6-b12409e70b62",
                  "title": "Exploiting login to gain higher privileges",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Elevation of privilege",
                  "description": "An attacker exploits vulnerabilities (e.g., session hijacking, weak authentication) to gain unauthorized access to privileged features (e.g., admin rights).",
                  "mitigation": "- Use secure session management (e.g., short-lived, signed tokens). \n - Implement role-based access control (RBAC) with minimal privileges. \n - Validate authentication flows to prevent session hijacking. \n - Test for privilege escalation vulnerabilities.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 67,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 635,
              "y": 90
            },
            "size": {
              "width": 110,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "Create Note"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 12,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5a9c4503-d326-46af-b20e-9239abda1c97"
                },
                {
                  "group": "right",
                  "id": "a134f719-045f-4081-a587-57fca23a13f7"
                },
                {
                  "group": "bottom",
                  "id": "0a89bf28-b545-44c1-8ea6-ba266d47bd1b"
                },
                {
                  "group": "left",
                  "id": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
                }
              ]
            },
            "id": "3c918a4e-2cbd-4d05-8369-98637dd37ea7",
            "data": {
              "type": "tm.Process",
              "name": "Create Note",
              "description": "A registered and logged in user creating a note.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "fa050cc2-872b-4c6d-92fe-f75ad095d1af",
                  "title": "Spoofed Create Note Process Request",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker or malicious internal component sends forged requests pretending to be the Create Note process, creating notes without authorisation.\n",
                  "mitigation": "Authenticate API calls internally, verify caller identites\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 7,
                  "score": ""
                },
                {
                  "id": "9b014e71-6282-4672-84cb-b4268597ca5e",
                  "title": "Tampering with Note Creation Data",
                  "status": "Mitigated",
                  "severity": "Critical",
                  "type": "Tampering",
                  "description": "Data passed into the Create Note process is manipulated en route or internally e.g. altering note text, images or links.",
                  "mitigation": "Input validation, cryptographic signing of data, integrity checks.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": ""
                },
                {
                  "id": "e0811de0-24f2-4bda-9727-132fb75b5d10",
                  "title": "Unlogged Create Note Actions",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Create Note process operations are not logged, enabling denial of note creation events.\n",
                  "mitigation": "Log all note creation events with timestamps and process identifiers.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": ""
                },
                {
                  "id": "ebffbf2f-1d7f-4894-97ea-7c2c116fdda6",
                  "title": "Leakage of Note Data in Process",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "The Create Note process unintentionally exposes note data e.g. via logs or error messages.",
                  "mitigation": "Avoid logging sensitive data, sanitise logs, secure error handling.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 10,
                  "score": ""
                },
                {
                  "id": "cc8bc425-6e26-4a4e-a6b1-b42024f3cd25",
                  "title": "Exhaustion via Create Note Process",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Flooding the Create Note process with requests causing resource exhaustion or crashing.\n",
                  "mitigation": "Rate limiting, load balancing.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 11,
                  "score": ""
                },
                {
                  "id": "0f5b3d9c-1886-409e-a1a7-f5f52e203bc5",
                  "title": "Unauthorised Privilege Escalation within the Create Note Process",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "The Create Note process might be exploited to bypass permission checks, allowing note creation with elevated privileges, such as creating notes under another user’s identity or with permissions the requester should not have.\n",
                  "mitigation": "Enforce strict server-side authorisation on note creation requests, ensuring the requester only creates notes they are permitted to, principle of least privilege.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 12,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 670,
              "y": 190
            },
            "size": {
              "width": 120,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "comment note"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 13,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5a9c4503-d326-46af-b20e-9239abda1c97"
                },
                {
                  "group": "right",
                  "id": "a134f719-045f-4081-a587-57fca23a13f7"
                },
                {
                  "group": "bottom",
                  "id": "0a89bf28-b545-44c1-8ea6-ba266d47bd1b"
                },
                {
                  "group": "left",
                  "id": "cb1bbb6c-ca1a-4056-9424-26cd5979da5d"
                }
              ]
            },
            "id": "ae5b180e-8a5e-4c91-ade9-8e097c52e2a5",
            "data": {
              "type": "tm.Process",
              "name": "comment note",
              "description": "A logged in user commenting on a public note or a note that has been shared with them",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "9110c435-f4fd-453c-b4cc-38a027ce10c0",
                  "title": "Spoofed Comment Process",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Malicious process or request pretending to be Comment on Note process. Malicious processes send forged requests to post comments under another user or process identity.\n",
                  "mitigation": "API authentication, authorisation checks, secure session management.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 19,
                  "score": ""
                },
                {
                  "id": "e07fd87f-1aaa-4383-bd85-289b935bcfeb",
                  "title": "Tampering with Comment Content",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "The commenting process may be tampered with, meaning that when a user submits a comment, it may actually submit a completely different comment or under another username or on a different note altogether",
                  "mitigation": "Input validation and sanitisation, integrity checks",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 20,
                  "score": ""
                },
                {
                  "id": "1f791866-88b4-4d06-8aac-0c65afffd351",
                  "title": "Unlogged Comment Actions",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Comment actions are not logged, allowing denial of sharing events.\n",
                  "mitigation": "Comprehensive logging of comments.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 21,
                  "score": ""
                },
                {
                  "id": "6daf3962-abaf-4741-a98d-138748044f57",
                  "title": "Leakage of Comment Data",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Comments exposed to unauthorised users or via logs/errors. Comments are made publicly available, even if the note itself is not public",
                  "mitigation": "Avoid logging sensitive data, sanitise logs, secure error handling, permission checks",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 22,
                  "score": ""
                },
                {
                  "id": "5e3ea19e-3b21-4e76-b2ee-99403fa738d9",
                  "title": "Flooding Comment Process",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Excessive comment submissions overwhelm resources, crashing appplication. ",
                  "mitigation": "Rate limiting, input validation, load balancing",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 23,
                  "score": ""
                },
                {
                  "id": "6c383e01-d1bd-4223-862c-42d71cab30a6",
                  "title": "Unauthorised Commenting",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Elevation of privilege",
                  "description": "A public visitor is able to comment on a note, without signing in or registering. ",
                  "mitigation": "Enforce authorisation",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 24,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 2,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 685,
              "y": -50.000000000000014
            },
            "size": {
              "width": 70,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "share note"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 14,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "b1ba4f0b-8db7-4234-8a3d-f050da7739d8"
                },
                {
                  "group": "right",
                  "id": "84d1fee3-8893-4c6f-804d-f6b73cbbdc11"
                },
                {
                  "group": "bottom",
                  "id": "c20d44d1-bfbb-4061-8596-b0783534c5ca"
                },
                {
                  "group": "left",
                  "id": "1957d505-d5fe-4806-a624-6de293e219c3"
                }
              ]
            },
            "id": "99f397fb-907a-4a13-9431-306b30d6d7ec",
            "data": {
              "type": "tm.Process",
              "name": "share note",
              "description": "The process of a note owner sharing their note via a messaging or sharing service. This includes the access level the recipient will have (read or write).",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "413e391a-4304-430c-b967-d2363a7b6537",
                  "title": "Spoofed Share Note Process",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Malicious process or request pretending to be Share Note process. Someone may send a malicious share link impersonating a real user.",
                  "mitigation": "API authentication, authorisation checks, secure session management.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 13,
                  "score": ""
                },
                {
                  "id": "e9790152-b9aa-4d70-b954-371974e14d9d",
                  "title": "Tampered Sharing Link Generation",
                  "status": "Mitigated",
                  "severity": "Critical",
                  "type": "Tampering",
                  "description": "The Share Note process generates or accepts tampered sharing links that grant unintended access eg. at incorrect access levels. Share Note process may actually perform some unintended action.\n",
                  "mitigation": "Input validation, cryptographically signed links.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 14,
                  "score": ""
                },
                {
                  "id": "31d96688-6714-424a-99b6-96c734b640d8",
                  "title": "Unlogged Share Note Actions",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Sharing actions are not logged, allowing denial of sharing events.\n",
                  "mitigation": "Comprehensive logging of sharing operations.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 15,
                  "score": ""
                },
                {
                  "id": "5e478a6e-c3b7-4559-a920-924bed1e43ca",
                  "title": "Unintended Exposure of Share Link or Permissions",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Share Note process leaks sharing links or permissions beyond intended recipients. This may happen via eg. error logs exposing the link.\n",
                  "mitigation": "Avoid logging sensitive data, sanitise logs, secure error handling, permission checks, secure link storage\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 16,
                  "score": ""
                },
                {
                  "id": "513c26e9-9cc2-458f-9ee8-6a55df510804",
                  "title": "Abuse of Share Note Process",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Flooding the sharing endpoint to exhaust system resources or disrupt service.",
                  "mitigation": "Rate limiting, load balancing, abuse detection",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 17,
                  "score": ""
                },
                {
                  "id": "29701e8b-54fe-4360-9da8-f1bb7780ce2e",
                  "title": "Privilege Escalation within the Share Note Process",
                  "status": "Mitigated",
                  "severity": "Critical",
                  "type": "Elevation of privilege",
                  "description": "Share Note process inadvertently grants edit permissions instead of read permission level via link tampering or logic flaws.\n",
                  "mitigation": "Enforce strict permission validation on sharing links.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 18,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 700,
              "y": 285
            },
            "size": {
              "width": 100,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "delete comment"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 15,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "b1ba4f0b-8db7-4234-8a3d-f050da7739d8"
                },
                {
                  "group": "right",
                  "id": "84d1fee3-8893-4c6f-804d-f6b73cbbdc11"
                },
                {
                  "group": "bottom",
                  "id": "c20d44d1-bfbb-4061-8596-b0783534c5ca"
                },
                {
                  "group": "left",
                  "id": "1957d505-d5fe-4806-a624-6de293e219c3"
                }
              ]
            },
            "id": "7b72297d-a801-4de7-a35a-ca9a44b0bd85",
            "data": {
              "type": "tm.Process",
              "name": "delete comment",
              "description": "The owner of a note deleting comments on their note",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "3634b2d5-30c7-412b-af81-54114eef1873",
                  "title": "Unwanted Deleted Comments",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Process receives forged delete requests from unauthorised entities. Delete requests may be unwanted by the note owner, but someone has impersonated the owner to delete comments",
                  "mitigation": "API authentication, authorisation checks, secure session management.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 25,
                  "score": ""
                },
                {
                  "id": "2627923b-ddae-409c-acdb-8543f935fb08",
                  "title": "Tampered Delete Requests",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Malformed or modified delete requests causing unintended comment deletions.\n",
                  "mitigation": "Input validation and integrity checks on delete requests.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 26,
                  "score": ""
                },
                {
                  "id": "db303e1a-3b19-4e7e-abf3-4dbea74d0c7a",
                  "title": "Unlogged Delete Comment Actions",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Delete comment actions not logged, enabling repudiation",
                  "mitigation": "Comprehensive logging of comment deletions.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 27,
                  "score": ""
                },
                {
                  "id": "472ac0e6-d795-4d2e-ba6b-0b7e50abb6bc",
                  "title": "Deleted Comments Recoverable",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "Deleted comment data accessible after deletion due to improper handling",
                  "mitigation": "Secure data deletion policies. Delete the comment data properly\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 28,
                  "score": ""
                },
                {
                  "id": "c5c3ad2b-eb16-465d-83c2-0b770aeb6511",
                  "title": "Mass Delete Request Flooding",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Flooding delete comment API causing service disruption.",
                  "mitigation": "Rate limiting, load balancing, abuse detection",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 29,
                  "score": ""
                },
                {
                  "id": "656bc557-c20f-4ea8-858f-c3db8288c96a",
                  "title": "Unauthorised Deleting of Comments",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Non-owners of the note are able to delete comments. ",
                  "mitigation": "Enforce strict permission checks when attempting to delete comments, ensure user deleting the comment is the owner",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 30,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 700,
              "y": 400
            },
            "size": {
              "width": 90,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "publicise note"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 16,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "b1ba4f0b-8db7-4234-8a3d-f050da7739d8"
                },
                {
                  "group": "right",
                  "id": "84d1fee3-8893-4c6f-804d-f6b73cbbdc11"
                },
                {
                  "group": "bottom",
                  "id": "c20d44d1-bfbb-4061-8596-b0783534c5ca"
                },
                {
                  "group": "left",
                  "id": "1957d505-d5fe-4806-a624-6de293e219c3"
                }
              ]
            },
            "id": "3318c40f-ec39-4ff8-b444-13905a7e3411",
            "data": {
              "type": "tm.Process",
              "name": "publicise note",
              "description": "The owner of a note changing the viewing setting of their note (public or private with shared secret access).",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "ba5477d6-0525-4d89-bb19-65e48037e5be",
                  "title": "Spoofed Public Toggle Requests",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Process receives forged requests from unauthorised entities to toggle note visibility. This could make a note public when owner only wants it private and vice versa. ",
                  "mitigation": "API authentication, authorisation checks, authenticate toggle operations",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 31,
                  "score": ""
                },
                {
                  "id": "3d4ee80a-1a08-45bf-9f74-f68c93df764c",
                  "title": "Tampered Public Toggle Data",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Manipulation of toggle request function which may cause unwanted and unintended actions. Manipulation of toggle request data causing unauthorised visibility changes.\n",
                  "mitigation": "Secure toggling functionality, Input validation, integrity checks ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 32,
                  "score": ""
                },
                {
                  "id": "bfb15c26-69cc-434c-85d2-23b093fd7a02",
                  "title": "Unlogged Publicise Actions",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Publicise actions not logged, enabling denial of action.",
                  "mitigation": "Comprehensive logging of Publicise actions.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 33,
                  "score": ""
                },
                {
                  "id": "ed8dbbf6-2626-46d8-91e7-e3fb3e3ccbd0",
                  "title": "Accidental Public Exposure via Process",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "Process fails to warn or confirm before making notes public, leading to accidental exposure.\n",
                  "mitigation": "UI warnings, confirmation dialogs.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 34,
                  "score": ""
                },
                {
                  "id": "2b70baf5-b7c3-4188-9960-a464ef8d218d",
                  "title": "Publicise Note Request Flooding",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Flooding Publicise Note API causing service disruption.",
                  "mitigation": "Rate limiting, load balancing, abuse detection",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 35,
                  "score": ""
                },
                {
                  "id": "b62fe82f-502d-4fd0-be1c-4bca3605f3eb",
                  "title": "Unauthorised Public Toggle",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "Non-owners of the note are able to change publicity of the note. ",
                  "mitigation": "Strict authorisation and authentication enforcement.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 36,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 780,
              "y": 150
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "edit note"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 17,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "326de36f-77b9-41f1-ac28-f44900c6d5dc"
                },
                {
                  "group": "right",
                  "id": "e6d25928-746e-46bd-a443-4759e9dc9b83"
                },
                {
                  "group": "bottom",
                  "id": "fe9b062b-4ec0-4f10-b77a-4688a5f46a9e"
                },
                {
                  "group": "left",
                  "id": "ea2086e3-adc8-49ad-9d39-73e84fc21308"
                }
              ]
            },
            "id": "9de5d91a-06ab-4309-84f7-fc06fb50c586",
            "data": {
              "type": "tm.Process",
              "name": "edit note",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "4d308c0d-72a6-4cbc-afca-e2b2ac90d877",
                  "title": "Impersonation to edit notes",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker impersonates a user with edit permissions (e.g., by stealing a session token or shared secret link) to modify notes unauthorized.",
                  "mitigation": "- Use secure, short-lived session tokens with HttpOnly and SameSite attributes. \n- Implement multi-factor authentication (MFA). \n- Ensure shared secret links are single-use or time-limited. \n- Validate user identity for edit actions.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 68,
                  "score": ""
                },
                {
                  "id": "17e3fb70-7d42-4169-aeec-30afdbe0657a",
                  "title": "Unauthorized modification of note content",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "An attacker alters note content in transit or exploits server vulnerabilities (e.g., weak input validation) to modify notes without permission.",
                  "mitigation": "- Enforce HTTPS with strong TLS configurations. \n- Implement strict server-side input validation and sanitization to prevent injection (e.g., XSS, SQL injection). \n- Validate user permissions before processing edits.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 69,
                  "score": ""
                },
                {
                  "id": "85643daf-454a-4241-afeb-2f9bbb7f0d2d",
                  "title": "Denial of note edit actions",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "A user with edit permissions modifies a note and denies making changes, causing disputes over note content.",
                  "mitigation": "- Log all note edit actions with timestamps, user IDs, and IP addresses. \n- Maintain version history for notes to track changes. \n- Require MFA for stronger user attribution.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 70,
                  "score": ""
                },
                {
                  "id": "ef5c8084-20f5-4956-a587-b46511d2b74e",
                  "title": "Exposure of note content during editing",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "An attacker intercepts note content or session data during the edit process, exposing sensitive information.",
                  "mitigation": "- Use secure, HttpOnly, and SameSite cookies for session tokens. \n- Encrypt sensitive note content in the database. \n- Restrict database access to the web application. \n- Audit server configurations for vulnerabilities.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 71,
                  "score": ""
                },
                {
                  "id": "9bdaf1cb-c68b-4325-8593-43c2bf5f8e75",
                  "title": "Disrupting the edit note functionality",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker floods the edit note endpoint, preventing users from saving or editing notes.",
                  "mitigation": "- Implement rate limiting on edit note endpoints. \n- Use a Web Application Firewall (WAF) to block malicious traffic. \n- Ensure server scalability to handle high loads. \n- Cache note data to reduce server load.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 72,
                  "score": ""
                },
                {
                  "id": "72e1cc25-71cc-4b5d-874b-4e37a03a5abc",
                  "title": "Gaining unauthorized edit permissions",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Elevation of privilege",
                  "description": "An attacker exploits vulnerabilities (e.g., session hijacking, weak permission checks) to edit notes without proper authorization.",
                  "mitigation": "- Implement role-based access control (RBAC) to enforce edit permissions. \n- Use secure session management (e.g., signed, short-lived tokens). \n- Validate permissions for every edit request. \n- Test for privilege escalation vulnerabilities.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 73,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 1
              }
            }
          }
        ]
      }
    ],
    "diagramTop": 3,
    "reviewer": "",
    "threatTop": 80
  }
}